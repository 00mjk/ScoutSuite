<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>AWS Scout2 Report</title>

    <!-- custom style inline for now -->
    <style>
    .item-margin {
        margin-left: 25px;
    }
    .finding-danger {
        color:  red;
    }
    .finding-warning {
        color: orange;
    }
    .finding-hidden {
        display: none;
    }
    </style>

    <!-- Bootstrap core CSS -->
    <link href="inc-bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="inc-bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="theme.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <!-- jQuery -->
    <script src="inc-jquery/jquery-1.10.2.min.js"></script>

    <!-- Handlebars -->
    <script src="inc-handlebars/handlebars-v1.1.2.js"></script>


    <script>

        var violations_array = new Array();

        <!-- Generic load function -->
        function load_aws_from_json(list, keyword, cols) {
            var id1 = '#' + keyword + '-list-template';
            var id2 = keyword + 's-list';
            var tmp = Handlebars.compile($(id1).html());
            var what = keyword + 's';
            document.getElementById(id2).innerHTML = tmp({items: list});
            if (cols >= 2) {
                var id3 = '#' + keyword + '-detail-template';
                var id4 = keyword + 's-details';
                var tmp = Handlebars.compile($(id3).html());
                document.getElementById(id4).innerHTML = tmp({items: list});
            }
        }

        <!-- Generic highlight finding function -->
        function highlight_violations(violations) {
            for (i in violations) {
                var idprefix = '';
                if ( violations[i]['idprefix'] != '') {
                    var idprefix = violations[i]['idprefix'] + '-';
                }
                var vkey = violations[i]['keyword_prefix'] + '-' + violations[i]['entity'] + '-' + violations[i]['name'];
                violations_array[vkey] = new Array();
                for (j in violations[i]['items']) {
                    var id = idprefix + violations[i]['items'][j];
                    var style = "finding-" + violations[i]['level'];
                    $('[id$="' + id + '"]').addClass(style);
                    $('[id$="' + id + '"]').show();
                    violations_array[vkey].push(violations[i]['macro_items'][j]);
                }
            }
        }

        <!-- Load EC2 data -->
        $.getJSON('json/aws_ec2_security_groups.json', function(data) {
            load_aws_from_json(data.security_groups, 'ec2-security_group', 2);
        });
        $.getJSON('json/aws_ec2_instances.json', function(data) {
            load_aws_from_json(data.instances, 'ec2-instance', 2);
        });
        $.getJSON('json/aws_ec2_violations.json', function(data) {
            load_aws_from_json(data.violations, 'ec2-violation', 1);
            highlight_violations(data.violations);
        });

        <!-- Load IAM data -->
        $.getJSON('json/aws_iam_users.json', function(data) {
            load_aws_from_json(data.list_users_response.list_users_result.users, 'iam-user', 2);
        });
        $.getJSON('json/aws_iam_groups.json', function(data) {
            load_aws_from_json(data.list_groups_response.list_groups_result.groups, 'iam-group', 2);
        });
        $.getJSON('json/aws_iam_roles.json', function(data) {
            load_aws_from_json(data.list_roles_response.list_roles_result.roles, 'iam-role', 2);
        });
        $.getJSON('json/aws_iam_permissions.json', function(data) {
            load_aws_from_json(data.permissions, 'iam-permission', 1);
        });
        $.getJSON('json/aws_iam_violations.json', function(data) {
            load_aws_from_json(data.violations, 'iam-violation', 1);
            highlight_violations(data.violations);
        });

        <!-- Load S3 data -->
        $.getJSON('json/aws_s3_buckets.json', function(data) {
            load_aws_from_json(data.buckets, 's3-bucket', 2);
        });
        $.getJSON('json/aws_s3_violations.json', function(data) {
            load_aws_from_json(data.violations, 's3-violation', 1);
            highlight_violations(data.violations);
        });

        // TODO: Hide all by default

        <!-- Display functions -->
        function hideAll() {
            $("[id$='-row']").hide();
            $("[id*='-details-']").hide();
        }
        function hideRowItems(keyword) {
            $("[id*='" + keyword + "-list']").hide();
            $("[id*='" + keyword + "-details']").hide();
        }
        function showEmptyRow(keyword) {
            id = "#" + keyword + "s-row";
            $(id).show();
            hideRowItems(keyword);
        }
        function showItem(keyword, id) {
            var id1 = '#' + keyword + '-list-' + id;
            var id2 = '#' + keyword + '-details-' + id;
            $(id1).show();
            $(id2).show();
        }
        function showRow(keyword) {
            id = "#" + keyword + "s-row";
            $(id).show();
        }
        function showRowWithDetails(keyword) {
            showRow(keyword);
            showAll(keyword);
        }
        function showAll(keyword) {
            $("[id*='" + keyword + "-list']").show();
            $("[id*='" + keyword + "-details']").show();
        }
        function toggleDetails(keyword, item) {
            var id = '#' + keyword + '-' + item;
            $(id).toggle();
        }
        function updateNavbar(active) {
            $('[id^="navbar-item-"]').removeClass('active');
            $('#navbar-item-'+active).addClass('active');
        }
        function toggleVisibility(id) {
            // Todo update image too, or something..
            $(id).toggle();
        }

        <!-- Navigation functions -->
        function browseTo(keyword, id) {
            hideAll();
            showRow(keyword);
            var html_id = "[id=\"" + keyword + "-details-" + id + "\"]";
            $(html_id).show();
            window.scrollTo(0,0);
        }
        function list_generic(keyword) {
            updateNavbar(keyword);
            hideAll();
            showRowWithDetails(keyword);
        }
        function list_findings(keyword_prefix, keyword, finding) {
            keyword = keyword_prefix + '-' + keyword;
            updateNavbar(keyword);
            hideAll();
            showEmptyRow(keyword);
            var violation_id = keyword + '-' + finding;
            for (item in  violations_array[violation_id]) {
                showItem(keyword, violations_array[violation_id][item]);
            }
        }

        <!-- Handlebars helpers -->
        Handlebars.registerHelper("decodeURIComponent", function(blob) {
            var test = decodeURIComponent(blob);
            test = test.replace(/ /g, '&nbsp;');
            test = test.replace(/\n/g, '<br />');
            return test;
        });
        Handlebars.registerHelper("has_profiles?", function(logins) {
            if(typeof logins != 'undefined' && logins != '') {
                return 'Yes';
            } else {
                return 'No';
            }
        });
        Handlebars.registerHelper('has_access_keys?', function(access_keys) {
            if (typeof access_keys != 'undefined' && access_keys != '') {
                return access_keys.length;
            } else {
                return 0;
            }
        });
        Handlebars.registerHelper('has_mfa?', function(mfa_devices) {
            if (typeof mfa_devices != 'undefined' && mfa_devices != '') {
                return 'Yes';
            } else {
                return 'No';
            }
        });
        Handlebars.registerHelper('format_grant', function(grants) {
            if (grants.match(/.*\(.*\)/)) {
                return 'EC2 Group: ' + grants;
            } else {
                return 'Source IP: ' + grants;
            }
        });
        Handlebars.registerHelper('list_permissions', function(permissions) {
            var r = '';
            if (typeof permissions != 'undefined' && permissions != '') {
                r += parse_entities('group', permissions.groups);
                r += parse_entities('role', permissions.roles);
                r += parse_entities('user', permissions.users);
            }
            return r;
        });
        var gc = {}; gc['group'] = 0; gc['role'] = 0; gc['user'] = 0;
        function parse_entities(keyword, permissions) {
            var p = '';
            var r = '';
            for (i in permissions) {
                p += format_entity(keyword, permissions[i].name, permissions[i].policy_name, gc[keyword]++);
            }
            if (p != '') {
                r = '<p>' + keyword.charAt(0).toUpperCase() + keyword.slice(1) + 's:</p><ul>' + p + '</ul>';
            }
            return r;
        }
        function format_entity(keyword, name, policy_name, c) {
            var r = '';
            r += "<li>" + name + " [<a href=\"javascript:toggleDetails('" + keyword + "'," + c + ")\">Details</a>]";
            r += "<div class=\"row\" style=\"display:none\" id=\"" + keyword + "-" + c + "\">" + policy_name + "</div></li>";
            return r;
        }
        Handlebars.registerHelper('list_group_instances', function(group_id, running, stopped) {
            var rc = count_instances(running);
            var sc = count_instances(stopped);
            var r = '';
            r += format_instances(group_id, running, rc, 'Running');
            r += format_instances(group_id, stopped, sc, 'Stopped');
            return r;
        });
        function count_instances(instances) {
            if (typeof instances != 'undefined' && instances != '') {
                return instances.length;
            } else {
                return 0;
            }
        }
        function format_instances(group_id, instances, count, title) {
            var r = '';
            r += '<ul><li>' + title + ': ' + count;
            if (count > 0) {
                r += ' <a href="javascript:toggleVisibility(\'#ec2-instances-' + group_id + '-' + title +'\')"><i class="glyphicon glyphicon-expand"></i></a>';
                r += '</li><div id="ec2-instances-' + group_id + '-' + title +'"><ul>';
                for (i in instances) {
                    r += '<li class="list-group-item-text"><a href="javascript:browseTo(\'ec2-instance\',\'' + instances[i] + '\')">' + instances[i] + '</a></li>';
                }
                r += '</ul></div>';
            } else {
                r += '</li>';
            }
            r += '</ul>';
            return r;
        }
        Handlebars.registerHelper('list_s3_permissions', function(bucket_name, grantee_name, grants) {
            var r = '';
            r += '<tr><td>' + grantee_name + '</td>';
            r += '<td class="text-center"><span id="s3-bucket-read-' + grantee_name + '-' + bucket_name + '"><i class="' + ((grants.read == true) ? 'glyphicon glyphicon-ok' : '') +'"></i></span></td>';
            r += '<td class="text-center"><span id="s3-bucket-write-' + grantee_name + '-' + bucket_name + '"><i class="' + ((grants.write == true) ? 'glyphicon glyphicon-ok' : '') +'"></i></span></td>';
            r += '<td class="text-center"><span id="s3-bucket-read_acp-' + grantee_name + '-' + bucket_name + '"><i class="' + ((grants.read_acp == true) ? 'glyphicon glyphicon-ok' : '') +'"></i></span></td>';
            r += '<td class="text-center"><span id="s3-bucket-write_acp-' + grantee_name + '-' + bucket_name + '"><i class="' + ((grants.write_acp == true) ? 'glyphicon glyphicon-ok' : '') +'"></i></span></td>';
            r += '</tr>';
            return r;
        });
        Handlebars.registerHelper('has_logging?', function(logging) {
            return logging;
        });

        <!-- Debug -->
        Handlebars.registerHelper('helpme', function(permission) {
            return xinspect(permission);
        });
        function xinspect(o,i){
            if (typeof i == 'undefined') i='';
            if (i.length > 50) return '[MAX ITERATIONS]';
            var r=[];
            for(var p in o){
                var t=typeof o[p];
                r.push(i+'"'+p+'" ('+t+') => '+(t=='object' ? 'object:'+xinspect(o[p],i+'  ') : o[p]+''));
            }
            return r.join(i+'\n');
        }

    </script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand" href="report.html">AWS Scout</a>
        </div>
        <div class="navbar-collapse collapse">
          <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a href="javascript:show_ec2()" class="dropdown-toggle" data-toggle="dropdown">EC2<b class="caret"></b></a>
              <ul class="dropdown-menu" id="ec2-violations-list">
                <script id="ec2-violation-list-template" type="text/x-handlebars-template">
                  <li><a href="javascript:list_generic('ec2-instance')">Instances</a></li>
                  <li><a href="javascript:list_generic('ec2-security_group')">Security Groups</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Security risks</li>
                  {{#each items}}
                    <li><a href="javascript:list_findings('{{{keyword_prefix}}}','{{{entity}}}','{{{name}}}')">{{{description}}}</a><li>
                  {{/each}}
                </script>
              </ul>
            <li class="dropdown">
              <a href="javascript:show_iam()" class="dropdown-toggle" data-toggle="dropdown">IAM<b class="caret"></b></a>
              <ul class="dropdown-menu" id="iam-violations-list">
                <script id="iam-violation-list-template" type="text/x-handlebars-template">
                  <li><a href="javascript:list_generic('iam-group')">Groups</a></li>
                  <li><a href="javascript:list_generic('iam-permission')">Permissions</a></li>
                  <li><a href="javascript:list_generic('iam-role')">Roles</a></li>
                  <li><a href="javascript:list_generic('iam-user')">Users</a></li>
                  <li><a href="javascript:void()">Password policy</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Security risks</li>
                  {{#each items}}
                    <li><a href="#">{{{description}}}</a><li>
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a href="javascript:show_s3()" class="dropdown-toggle" data-toggle="dropdown">S3<b class="caret"></b></a>
              <ul class="dropdown-menu" id="s3-violations-list">
                <script id="s3-violation-list-template" type="text/x-handlebars-template">
                  <li><a href="javascript:list_generic('s3-bucket')">Buckets</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Security risks</li>
                  {{#each items}}
                    <li><a href="#">{{{description}}}</a></li>
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Help<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="#">About AWS Scout2</a></li>
                <li><a href="#">Security findings</a></li>
                <li><a href="#">Related documentation</a></li>
                <li class="divider"></li>
                <li class="dropdown-header">Nav header</li>
                <li><a href="#">Separated link</a></li>
                <li><a href="#">One more separated link</a></li>
              </ul>
            </li>
          </ul>
          </div>
        </div><!--/.nav-collapse -->
      </div>

    </div>

    <div class="container theme-showcase" id="container-user">

      <div class="page-header">
      </div>

      <!-- Template for EC2 instances -->
      <div class="row" id="ec2-instances-row">
        <div class="col-sm-4">
          <ul class="list-group" id="ec2-instances-list">
            <script id="ec2-instance-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('ec2-instance')">Show all</a></li>
            {{#each items}}
              <li class="list-group-item">
                <a href="javascript:browseTo('ec2-instance','{{{id}}}')">{{{id}}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="ec2-instances-details">
          <script id="ec2-instance-detail-template" type="text/x-handlebars-template">
          {{#each items}}
          <div class="list-group" id="ec2-instance-details-{{{id}}}">
            <div class="list-group-item active">
              <h4 class="list-group-item-heading">{{{id}}}</h4>
            </div>
            <div class="list-group-item">
              <h4>Information</h4>
              <ul>
                <li class="list-group-item-text">Region: {{{region}}}</li>
                <li class="list-group-item-text">Reservation ID: {{{reservation_id}}}</li>
                <li class="list-group-item-text">Access Key name: {{{key_name}}}</li>
                <li class="list-group-item-text">State: {{{state}}}</li>
                <li class="list-group-item-text">Up since: {{{launch_time}}}</li>
              </ul>
            </div>
            <div class="list-group-item">
              <h4>Network</h4>
              <ul>
                <li class="list-grou-item-text">Public IP: {{{ip_address}}}</li>
                <li class="list-grou-item-text">Public DNS: {{{public_dns_name}}}</li>
                <li class="list-grou-item-text">Private IP: {{{private_ip_address}}}</li>
                <li class="list-grou-item-text">Private DNS: {{{private_dns_name}}}</li>
              </ul>
            </div>
          </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for EC2 security groups -->
      <div class="row" id="ec2-security_groups-row">
        <div class="col-sm-4">
          <ul class="list-group" id="ec2-security_groups-list">
            <script id="ec2-security_group-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('ec2-security_group')">Show all</a></li>
            {{#each items}}
              <li class="list-group-item" id="ec2-security_group-list-{{{id}}}">
                <a href="javascript:browseTo('ec2-security_group','{{{id}}}')">{{{name}}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="ec2-security_groups-details">
          <script id="ec2-security_group-detail-template" type="text/x-handlebars-template">
          {{#each items}}
          <div class="list-group" id="ec2-security_group-details-{{{id}}}">
            <div class="list-group-item active">
              <h4 class="list-group-item-heading">{{{name}}} ({{{id}}})</h4>
              <p class="list-group-item-text">{{{description}}}</p>
            </div>
            <div class="list-group-item">
              <h4 class="list-group-item-heading">Rules</h4>
              <ul>
              {{# each protocols}}
                <li class="list-group-item-text">{{{name}}}</li>
                  <ul>
                  {{# each rules}}
                    <li class="list-group-item-text">Ports: <span id="{{{../../id}}}-{{{../name}}}-{{{ports}}}">{{{ports}}}</span></li>
                    <ul>
                    {{# each grants}}
                      <li class="list-group-item-text"><span id="{{{../../../id}}}-{{{../../name}}}-{{{../ports}}}-{{{this}}}">{{{format_grant this}}}</span></li>
                    {{/each}}
                    </ul>
                  {{/each}}
                </ul>
              {{/each}}
              </ul>
            </div>
            <div class="list-group-item">
              <h4 class="list-group-item-heading">Instances</h4>
              {{{list_group_instances id running-instances stopped-instances}}}
            </div>
          </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for IAM groups -->
      <div class="row" id="iam-groups-row">
        <div class="col-sm-4">
          <ul class="list-group" id="iam-groups-list">
            <script id="iam-group-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('iam-group')">Show all</a></li>
            {{#each items}}
              <li class="list-group-item">
                <a href="javascript:browseTo('iam-group','{{{group_id}}}')">{{{group_name}}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="iam-groups-details">
          <script id="iam-group-detail-template" type="text/x-handlebars-template">
          {{#each items}}
          <div class="list-group" id="iam-group-details-{{{group_id}}}">
            <div class="list-group-item active">
              <h4 class="list-group-item-heading">{{{group_name}}}</h4>
              <p class="list-group-item-text"> * Group created on {{{create_date}}}</p>
            </div>
            <div class="list-group-item">
              <h4 class="list-group-item-heading">Members</h4>
              <ul>
              {{#each users}}
                <li class="list-group-item-text"><a href="javascript:browseTo('iam-user','{{{this}}}')">{{{this}}}</a></li>
              {{/each}}
              </ul>
            </div>
            <div class="list-group-item">
              <h4 class="list-group-item-heading">Group Policies</h4>
              <ul>
              {{#each policies}}
                <li class="list-group-item-text">
                {{{policy_name}}} [<a href="javascript:toggleDetails('iam-group_policy_details','{{{policy_name}}}')">Details</a>]
                <p class="list-group-item-text" id="iam-group_policy_details-{{{policy_name}}}" style="display:none">{{{decodeURIComponent policy_document}}}</p>
                </li>
              {{/each}}
              </ul>
            </div>
          </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for IAM permissions -->
      <div class="row" id="iam-permissions-row">
        <div id="iam-permissions-list"></div>
          <script id="iam-permission-list-template" type="text/x-handlebars-template">
          <div class="row list-group-item active">
            <div class="col-sm-4"><h4>Permission</h4></div>
            <div class="col-sm-4"><h4>Allow</h4></div>
            <div class="col-sm-4"><h4>Deny</h4></div>
          </div>
          {{#each items}}
            <div class="row list-group-item" id="iam-permission-details-{{{@key}}}">
              <div class="col-sm-4">{{{@key}}}</div>
              <div class="col-sm-4">{{{list_permissions Allow}}}</div>
              <div class="col-sm-4">{{{list_permissions Deny}}}</div>
            </div>
          {{/each}}
          </script>
      </div><!-- /.row -->

      <!-- Template for IAM roles -->
      <div class="row" id="iam-roles-row">
        <div class="col-sm-3">
          <ul class="list-group" id="iam-roles-list">
            <script id="iam-role-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('iam-role')">Show all</a></li>
            {{#each items}}
              <li class="list-group-item">
                <a href="javascript:browseTo('iam-role','{{{role_id}}}')">{{{role_name}}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="iam-roles-details">
          <script id="iam-role-detail-template" type="text/x-handlebars-template">
          {{#each items}}
          <div class="list-group" id="iam-role-details-{{{role_id}}}">
            <div class="list-group-item active">
              <h4 class="list-group-item-heading">{{{role_name}}}</h4>
            </div>
            <div class="list-group-item">
              <h4 class="list-group-item-heading">Information</h4>
              <ul>
                <li class="list-group-item-text"> Role created on {{{create_date}}}</li>
              </ul>
            </div>
            <div class="list-group-item">
              <h4 class="list-group-item-heading">Role Policies</h4>
              <div>
              <ul>
              {{#each policies}}
                <li class="list-group-item-text">
                {{{policy_name}}} [<a href="javascript:toggleDetails('iam-role_policy_details','{{{policy_name}}}')">Details</a>]
                <p class="list-group-item-text" id="iam-role_policy_details-{{{policy_name}}}" style="display:none">{{{decodeURIComponent policy_document}}}</p>
                </li>
              {{/each}}
              </ul>
              </div>
            </div>
          </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for IAM users -->
      <div class="row" id="iam-users-row">
        <div class="col-sm-4">
          <ul class="list-group" id="iam-users-list">
            <script id="iam-user-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('iam-user')">Show all</a></li>
            {{#each items}}
              <li class="list-group-item">
                <a href="javascript:browseTo('iam-user','{{{user_name}}}')">{{{user_name}}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="iam-users-details">
          <script id="iam-user-detail-template" type="text/x-handlebars-template">
          {{#each items}}
          <div class="list-group" id="iam-user-details-{{{user_name}}}">
            <div class="list-group-item active">
              <h4 class="list-group-item-heading">{{{user_name}}}</h4>
              <p class="list-group-item-text"> * Account created on {{{create_date}}}</p>
            </div>
            <div class="list-group-item">
              <h4 class="list-group-item-heading">Authentication methods</h4>
              <p class="list-group-item-text">Password enabled: {{{has_profiles? logins}}}</p>
              <ul></ul>
              <p class="list-group-item-text">Multi-Factor enabled: <span id="mfa-enabled-{{{user_name}}}">{{{has_mfa? mfa_devices}}}</span></p>
              <ul>
              {{#each mfa_devices}}
                <li class="list-group-item-text"> Serial number: {{{serial_number}}}</li>
              {{/each}}
              </ul>
              <p class="list-group-item-text">Access Keys: {{{has_access_keys? access_keys}}}</p>
              <ul>
              {{#each access_keys}}
                <li class="list-group-item-text"><span id="access-key-{{{access_key_id}}}"> {{{access_key_id}}}, {{{status}}}, created on {{{create_date}}}</span></li>
              {{/each}}
              </ul>
              <p class="list-group-item-text"><span class="finding-hidden" id="password-and-key-enabled-{{{user_name}}}"><i class="glyphicon glyphicon-warning-sign"></i> Review the need for password-based and key-based authentication</span></p>
            </div>

            <div class="list-group-item">
              <h4 class="list-group-item-heading">Groups</h4>
              <ul>
              {{#each groups}}
                <li class="list-group-item-text"><a href="javascript:browseTo('iam-group','{{{group_id}}}')">{{{group_name}}}</a></li>
              {{/each}}
              </ul>
            </div>
            <div class="list-group-item">
              <h4 class="list-group-item-heading">User Policies</h4>
              <div>
              <ul>
              {{#each policies}}
                <li class="list-group-item-text">
                {{{policy_name}}} [<a href="javascript:toggleDetails('iam-user_policy_details','{{{policy_name}}}')">Details</a>]
                <p class="list-group-item-text" id="iam-user_policy_details-{{{policy_name}}}" style="display:none">{{{decodeURIComponent policy_document}}}</p>
                </li>
              {{/each}}
              </ul>
              </div>
            </div>
          </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for S3 buckets -->
      <div class="row" id="s3-buckets-row">
        <div class="col-sm-4">
          <ul class="list-group" id="s3-buckets-list">
            <script id="s3-bucket-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('s3-bucket')">Show all</a></li>
            {{#each items}}
              <li class="list-group-item">
                <a href="javascript:browseTo('s3-bucket','{{{name}}}')">{{{name}}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="s3-buckets-details">
          <script id="s3-bucket-detail-template" type="text/x-handlebars-template">
          {{#each items}}
          <div class="list-group" id="s3-bucket-details-{{{name}}}">
            <div class="list-group-item active">
              <h4 class="list-group-item-heading">{{{name}}}</h4>
            </div>
            <div class="list-group-item">
              <h4 class="list-group-item-heading">Information</h4>
              <div class="list-group-item-text item-margin">Creation date: {{{creation_date}}}</div>
              <div class="list-group-item-text item-margin">Region: {{{region}}}</div>
              <div class="list-group-item-text item-margin">Logging: {{{has_logging? logging}}}</div>
              <div class="list-group-item-text item-margin">Versioning: {{{versioning}}}</div>
            </div>
            <div class="list-group-item">
              <h4 class="list-group-item-heading">Permissions</h4>
              <table class="table-striped" width="100%" >
                <tr>
                  <td></td>
                  <td class="text-center">Read access</td>
                  <td class="text-center">Write access</td>
                  <td class="text-center">Read ACP</td>
                  <td class="text-center">Write ACP</td>
                </tr>
              {{#each grants}}
                {{{list_s3_permissions ../name @key this}}}
              {{/each}}
              </table>
            </div>
          </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

    </div> <!-- /container -->

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="inc-bootstrap/js/bootstrap.min.js"></script>
  </body>
</html>
