<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>AWS Scout2 Report</title>

    <!-- Bootstrap core CSS -->
    <link href="inc-bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="inc-bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <!-- jQuery -->
    <script src="inc-jquery/jquery-1.11.2.min.js"></script>

    <!-- Handlebars -->
    <script src="inc-handlebars/handlebars-v3.0.0.js"></script>

    <!-- Scout2 -->
    <script src="inc-scout2/scout2.js"></script>
    <link href="inc-scout2/scout2.css" rel="stylesheet">

  </head>

  <body>

    <!-- Finding menu item partial -->
    <script id="finding_menu_item-partial" type="text/x-handlebars-template">
      {{#if items}}
        <li><a href="javascript:list_findings('{{finding_entity keyword_prefix entity}}', aws_info['services']['{{keyword_prefix}}']['violations'], '{{@key}}')">
          {{description}} ({{items.length}})
        </a></li>
      {{/if}}
    </script>
    <script>
        Handlebars.registerPartial("finding_menu_item", $("#finding_menu_item-partial").html());
    </script>

    <!-- Accordion partial -->
    <script id="accordion-partial" type="text/x-handlebars-template">
        <div class="list-group-item" style="padding-bottom: 0 !important;">
          <div class="accordion">
            <h4 class="list-group-item-heading accordion-heading">{{make_title member_type}}
              <a class="accordion-toggle" data-toggle="collapse" href="#{{service_name}}-{{resource_type}}-{{resource_id}}-{{member_type}}"><span class="badge pull-right btn-info">{{members.length}}</span></a>
            </h4>
            <div id="{{service_name}}-{{resource_type}}-{{resource_id}}-{{member_type}}" class="accordion-body collapse">
              <div class="accordion-inner">
                <ul>
                  {{#each members}}
                    <li>{{> (lookup .. 'member_partial_name')}}</li>
                  {{/each}}
                </ul>
              </div>
            </div>
          </div>
        </div>
    </script>
    <script>
        Handlebars.registerPartial("accordion", $("#accordion-partial").html());
    </script>

    <!-- Generic dashboard partial -->
    <script id="dashboard-partial" type="text/x-handlebars-template">
      <div class="container">
        {{#grouped_each 3 items}}
          <div class="row">
            {{#each this}}
              <div class="col-sm-4">
                <div class="list-group-item finding-title-{{dashboard_color level checked_items flagged_items}} plain-link">
                  <a href="javascript:list_findings('{{finding_entity keyword_prefix entity}}', aws_info['services']['{{keyword_prefix}}']['violations'], '{{@key}}')">
                    {{description}}
                  </a>
                </div>
                <div class="list-group-item">
                  <ul>
                    <li>{{friendly_name entity}} checked: {{checked_items}}</li>
                    <li>{{friendly_name entity}} flagged: {{flagged_items}}</li>
                  </ul>
                </div>
              </div>
            {{/each}}
          </div>
        {{/grouped_each}}
      </div>
    </script>
    <script>
      Handlebars.registerPartial("dashboard", $("#dashboard-partial").html());
    </script>

    <!-- Generic left-menu partial for region-then-vpc-then-resource -->
    <script id="region_vpc-partial" type="text/x-handlebars-template">
{{#if is_menu}}
      <ul class="list-group">
        <li class="list-group-item">
          <a href="javascript:showAll('{{service_name}}_{{resource_type}}')">
            Show all<span class="badge pull-right">{{count_in "{{service_name}}" "regions.vpcs.{{resource_type}}"}}</span>
          </a>
        </li>
      </ul>
{{/if}}
      {{#each regions}}
{{#if ../is_menu}}
        <ul class="list-group" id="{{../service_name}}_region-list-{{@key}}">
          <li class="list-group-item active">{{@key}}</li>
{{/if}}
          {{#each vpcs}}
{{#if ../../is_menu}}
            <div class="list-group-item list-sub-element">{{@key}}
{{/if}}
              {{#each (lookup . ../../resource_type)}}
                {{> (lookup ../../.. 'partial_name') service_name = ../../../service_name region = @../../key vpc = @../key resource_type = ../../../resource_type resource_key = @key resource = this}}
              {{/each}}
{{#if ../../is_menu}}
            </div>
{{/if}}
          {{/each}}
{{#if ../is_menu}}
        </ul>
{{/if}}
      {{/each}}
    </script>
    <script>
      Handlebars.registerPartial("region_vpc", $("#region_vpc-partial").html());
    </script>
    <!-- Generic left-menu link partial for region-then-vpc-then-resource -->
    <script id="region_vpc_link-partial" type="text/x-handlebars-template">
      <div class="list-group-item-text list-sub-element" id="{{service_name}}_{{resource_type}}-list-{{resource_key}}">
        <a href="#{{service_name}}/regions/{{region}}/vpcs/{{vpc}}/{{resource_type}}/{{resource_key}}/details">{{resource_key}}</a>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("region_vpc_link", $("#region_vpc_link-partial").html());
    </script>
 

    <!-- CloudTrail trail partial -->
    <script id="cloudtrail_region-partial" type="text/x-handlebars-template">
      <div class="list-group" id="cloudtrail_region-details-{{name}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{name}}</h4>
        </div>
        <div class="list-group-item">
        <h4>Information</h4>
          <ul>
            {{#each trails}}
              <li class="list-group-item-text">Name: {{Name}}</li>
              <li class="list-group-item-text">Enabled: {{IsLogging}}</li>
              <li class="list-group-item-text">Start Logging Time: {{StartLoggingTime}}</li>
              <li class="list-group-item-text">Stop Logging Time: {{StopLoggingTime}}</li>
              <li class="list-group-item-text">Include global services:
                <span id="cloudtrail_-global-services-duplicated-{{../name}}"><span id="cloudtrail_-no-global-services-{{../name}}">
                  {{#if IncludeGlobalServiceEvents}}True{{else}}False{{/if}}
                </span></span>
              </li>
              <li class="list-group-item-text">Destination S3 bucket name: <a href="javascript:showS3Bucket('{{S3BucketName}}')">{{S3BucketName}}</a>/{{S3KeyPrefix}}</li>
            {{else}}
               <li class="list-group-item-text">CloudTrail disabled</li>
            {{/each}}
             <li class="list-group-item-text">EC2 instances: {{count_ec2_in_region name "vpcs.instances"}}
          </ul>
        </div>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("cloudtrail_region", $("#cloudtrail_region-partial").html());
    </script>

    <!-- IP grant -->
    <script id="ip_grants-partial" type="text/x-handlebars-template">
      <ul>
        {{#each items}}
          <span id="ec2_security_groups-{{../protocol}}-{{../ports}}-{{this}}-{{../sg_id}}">
          <span id="ec2_security_groups-ports-range-{{../sg_id}}-{{../ports}}">
          <span id="ec2_security_groups-all-ports-open-to-self-{{../sg_id}}">
          <span class="ec2_attack_surface_item">
            <li class="list-group-item-text">{{this}}</li>
          </span></span></span>
        {{/each}}
      </ul>
    </script>
    <script>
        Handlebars.registerPartial("ip_grants", $("#ip_grants-partial").html());
    </script>

    <!-- EC2 grant -->
    <script id="ec2_grants-partial" type="text/x-handlebars-template">
      <ul>
        {{#each items}}
          <span id="ec2_security_groups-{{../protocol}}-{{../ports}}-{{this}}-{{../sg_id}}">
          <span id="ec2_security_groups-ports-range-{{../sg_id}}-{{../ports}}">
          <span id="ec2_security_groups-all-ports-open-to-self-{{../sg_id}}">
          <span class="ec2_attack_surface_item">
            {{#if GroupName}}
              <li class="list-group-item-text">{{GroupName}} (<a href="javascript:findAndShowEC2Object('regions.vpcs.security_groups', '{{GroupId}}')">{{GroupId}}</a>)</li>
            {{else}}
              <li class="list-group-item-text">{{GroupId}} (AWS account ID {{UserId}})</li>
            {{/if}}
          </span></span></span>
        {{/each}}
      </ul>
    </script>
    <script>
        Handlebars.registerPartial("ec2_grants", $("#ec2_grants-partial").html());
    </script>

    <!-- EC2 ELB partial -->
    <script id="ec2_elb-partial" type="text/x-handlebars-template">
      <div class="list-group" id="ec2_elb-details-{{Name}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{Name}}</h4>
        </div>
        <div class="list-group-item">
          <h4>Network</h4>
          <ul>
            <li class="list-group-item-text">VPC: {{VpcId}}</li>
            <li class="list-group-item-text">DNS: {{DnsName}}</li>
            <li class="list-group-item-text">Availability zones:</li>
            <ul>
              {{#each AvailabilityZones}}
                <li class="list-group-item-text">{{this}}</li>
              {{/each}}
            </ul>
          </ul>
        </div>
        <div class="list-group-item">
          <h4>Listeners</h4>
          <ul>
          {{#each listeners}}
            <li class="list-group-item-text">
              {{LoadBalancerPort}} ({{Protocol}}) <i class="glyphicon glyphicon-arrow-right"></i> {{InstancePort}} ({{InstanceProtocol}})
              {{#if SslCertificateId}} :
                {{#each policy_names}}
                  <span id="ec2_elbs-old-ssl-policy-{{../../../name}}-{{this}}">{{this}}</span>
                {{/each}}
              {{/if}}
            </li>
          {{/each}}
          </ul>
        </div>
        <div class="list-group-item">
          <h4>Destination</h4>
          <ul>
            <li class="list-group-item-text">Security groups:  <span class="badge pull-right btn-info">{{count SecurityGroups}}</span></li>
            <li class="list-group-item-text">Instances: <span class="badge pull-right btn-info">{{count Instances}}</span></li>
            <li class="list-group-item-text">Subnets: <span class="badge pull-right btn-info">{{count Subnets}}</span></li>
        </div>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("ec2_elb", $("#ec2_elb-partial").html());
    </script>

    <!-- EC2 security group partials -->
    <script id="ec2_security_group-partial" type="text/x-handlebars-template">
      <div class="list-group" id="ec2_security_group-details-{{id}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{this.name}}</h4>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Information</h4>
          <div class="list-group-item-text item-margin">Description: {{description}}</div>
          <div class="list-group-item-text item-margin">ID: {{id}}</div>
        </div>
        {{#each rules}}
          {{> ec2_security_group-rule_list this sg_name = ../name sg_id = ../id direction = @key}}
        {{/each}}
        {{#if instances}}
          <div class="list-group-item">
            <h4 class="list-group-item-heading">Instances</h4>
            {{#each instances}}
              {{> ec2_security_group-instance_list instances=this status=@key region=../region vpc=../vpc group=../id}}
            {{/each}}
          </div>
        {{/if}}
      </div>
    </script>
    <script>
        Handlebars.registerPartial("ec2_security_group", $("#ec2_security_group-partial").html());
    </script>
    <!-- EC2 security group instances partial -->
    <script id="ec2_security_group-instance_list-partial" type="text/x-handlebars-template">
      {{#if instances}}
        <div class="accordion">
          <h5 class="list-group-item-heading item-margin accordion-heading">{{make_title status}}
            <a class="accordion-toggle" data-toggle="collapse" href="#ec2_security_group-{{group}}-instance_list-{{status}}">
              <span class="badge pull-right btn-info">{{instances.length}}</span>
            </a>
          </h5>
          <div id="ec2_security_group-{{group}}-instance_list-{{status}}" class="accordion-body collapse">
            <div class="accordion-inner">
              <ul class="no-bullet">
              {{#each instances}}
                <li class="list-group-item-text"><a href="javascript:showEC2Instance('{{../region}}','{{../vpc}}','{{this}}')">{{this}}</a></li>
              {{/each}}
              </ul>
            </div>
          </div>
        </div>
      {{else}}
        <h5 class="list-group-item-heading item-margin accordion-heading">{{status}}
          <span class="badge pull-right">{{instances.length}}</span>
        </h5>
      {{/if}}
    </script>
    <script>
      Handlebars.registerPartial("ec2_security_group-instance_list", $("#ec2_security_group-instance_list-partial").html());
    </script>
    <!-- EC2 security group rules partial -->
    <script id="ec2_security_group-rule_list-partial" type="text/x-handlebars-template">
      <div class="list-group-item">
        <h4 class="list-group-item-heading">{{make_title direction}} Rules</h4>
        <ul>
        {{#each protocols}}
          <li class="list-group-item-text">{{@key}}</li>
          <ul>
            <li class="list-group-item-text">Ports:
            <ul>
            {{#each ports}}
              <li>{{@key}}</li>
              <ul>
              {{#if cidrs}}
                <li class="list-group-item-text">IP addresses:</li>
                {{> ip_grants items = cidrs protocol = @../key ports = @key sg_id = ../../../sg_id}}
              {{/if}}
              {{#if security_groups}}
                <li class="list-group-item-text">EC2 security groups:</li>
                {{> ec2_grants items = security_groups protocol = @../key ports = @key sg_id = ../../../sg_id}}
              {{/if}}
              </ul>
            {{/each}}
            </ul>
          </ul>
        {{/each}}
        </ul>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("ec2_security_group-rule_list", $("#ec2_security_group-rule_list-partial").html());
    </script>

    <!-- EC2 Network ACL partial -->
    <script id="ec2_network_acl-partial" type="text/x-handlebars-template">
        <div id="ec2_region-details-{{RegionName}}">
            <div class="list-group" id="ec2_network_acl-details-{{NetworkAclId}}">
            <div class="list-group-item active">
                <h4 class="list-group-item-heading">{{NetworkAclId}}</h4>
            </div>
            {{#each rules}}
              <div class="list-group-item">
                <h4 class="list-group-item-heading">{{make_title @key}} rules</h4>
                <table class="table-striped" width="100%">
                  <tr>
                    <td width="20%" class="text-center">Rule number</td>
                    <td width="20%" class="text-center">Port</td>
                    <td width="20%" class="text-center">Protocol</td>
                    <td width="20%" class="text-center">IP address</td>
                    <td width="20%" class="text-center">Action</td>
                  </tr>
                  {{#each this}}
                    <tr>
                      <td width="20%" class="text-center">{{RuleNumber}}</td>
                      <td width="20%" class="text-center">{{port_range}}</td>
                      <td width="20%" class="text-center">{{protocol}}</td>
                      <td width="20%" class="text-center">{{CidrBlock}}</td>
                      <td width="20%" class="text-center">{{RuleAction}}</td>
                    </tr>
                  {{/each}}
                </table>
              </div>
            {{/each}}
        </div>
    </script>
    <script>
      Handlebars.registerPartial("ec2_network_acl", $("#ec2_network_acl-partial").html());
    </script>


    <!-- EC2 VPC partial -->
    <script id="ec2_vpc-partial" type="text/x-handlebars-template">
      <div class="list-group" id="ec2_vpc-details-{{id}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{Name}}</h4>
        </div>
        <div class="list-group-item">
          <h4>Information</h4>
          <ul>
            <li class="list-group-item-text">Region: {{region}}</li>
            <li class="list-group-item-text">ID: {{id}}</li>
            <li class="list-group-item-text">Name: {{Name}}</li>
          </ul>
        </div>
        <div class="list-group-item" style="padding-bottom: 0 !important;">
          <div class="accordion">
            <h4 class="list-group-item-heading accordion-heading">Network ACLs
              <a class="accordion-toggle" data-toggle="collapse" href="#ec2_vpc-{{id}}-network_acls"><span class="badge pull-right btn-info">{{count_vpc_network_acls network_acls}}</span></a>
            </h4>
            <div id="ec2_vpc-{{id}}-network_acls" class="accordion-body collapse">
              <div class="accordion-inner">
                <ul class="no-bullet">
                  {{#each network_acls}}
                    <li><a href="javascript:findAndShowEC2Object('regions.vpcs.network_acls', '{{@key}}')">{{@key}}</a></li>
                  {{/each}}
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="list-group-item" style="padding-bottom: 0 !important;">
          <div class="accordion">
            <h4 class="list-group-item-heading accordion-heading">Instances
              <a class="accordion-toggle" data-toggle="collapse" href="#ec2_vpc-{{id}}-instances"><span class="badge pull-right btn-info">{{count_vpc_instances instances}}</span></a>
            </h4>
            <div id="ec2_vpc-{{id}}-instances" class="accordion-body collapse">
              <div class="accordion-inner">
                <ul class="no-bullet">
                  {{#each instances}}
                    <li><a href="javascript:findAndShowEC2Object('regions.vpcs.instances', '{{@key}}')">{{@key}}</a></li>
                  {{/each}}
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("ec2_vpc", $("#ec2_vpc-partial").html());
    </script>


    <!-- EC2 instance partial -->
    <script id="ec2_instance-partial" type="text/x-handlebars-template">
      <div class="list-group" id="ec2_instance-details-{{InstanceId}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{Name}}</h4>
        </div>
        <div class="list-group-item">
          <h4>Information</h4>
          <ul>
            <li class="list-group-item-text">Region: {{region}}</li>
            <li class="list-group-item-text">ID: {{InstanceId}}</li>
            <li class="list-group-item-text">Reservation ID: {{reservation_id}}</li>
            <li class="list-group-item-text">Access Key name: {{KeyName}}</li>
            <li class="list-group-item-text">State: {{make_title State.Name}}</li>
            <li class="list-group-item-text">Instance Type:
              <span id="ec2_instances-unscannable-instance-types-{{InstanceId}}"> {{InstanceType}}<span>
            </li>
            <li class="list-group-item-text">Up since: {{LaunchTime}}</li>
          </ul>
        </div>
        <div class="list-group-item">
          <h4>Network</h4>
          <ul>
            <li class="list-group-item-text">Public IP: {{PublicIpAddress}}</li>
            <li class="list-group-item-text">Public DNS: {{PublicDnsName}}</li>
            <li class="list-group-item-text">Private IP: {{PrivateIpAddress}}</li>
            <li class="list-group-item-text">Private DNS: {{PrivateDnsName}}</li>
          </ul>
        </div>
        <div class="list-group-item" style="padding-bottom: 0 !important;">
          <div class="accordion">
            <h4 class="list-group-item-heading accordion-heading">Security groups
              <a class="accordion-toggle" data-toggle="collapse" href="#ec2_instance-{{InstanceId}}-security_groups"><span class="badge pull-right btn-info">{{security_groups.length}}</span></a>
            </h4>
            <div id="ec2_instance-{{InstanceId}}-security_groups" class="accordion-body collapse">
              <div class="accordion-inner">
                <ul class="no-bullet">
                  {{#each security_groups}}
                    <li><a href="javascript:findAndShowEC2Object('regions.vpcs.security_groups', '{{GroupId}}')">{{GroupName}}</a></li>
                  {{/each}}
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("ec2_instance", $("#ec2_instance-partial").html());
    </script>

    <!-- IAM group partial -->
    <script id="iam_Group-partial" type="text/x-handlebars-template">
      <div class="list-group" id="iam_Group-details-{{Name}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{Name}}</h4>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Information</h4>
          <div class="list-group-item-text item-margin">Creation date: {{CreateDate}}</div>
        </div>
        <div class="list-group-item" style="padding-bottom: 0 !important;">
          <div class="accordion">
            <h4 class="list-group-item-heading accordion-heading">Members
              {{#if Users}}
                <a class="accordion-toggle" data-toggle="collapse" href="#iam_Group-{{Name}}"><span class="badge pull-right btn-info">{{Users.length}}</span></a>
              {{else}}
                <span class="badge pull-right">{{Users.length}}</span>
              {{/if}}
            </h4>
            <div id="iam_Group-{{Name}}" class="accordion-body collapse">
              <div class="accordion-inner">
                <ul class="no-bullet">
                  {{#each Users}}
                    <li><a href="javascript:showIAMUser('{{this}}')">{{this}}</a></li>
                  {{/each}}
                </ul>
              </div>
            </div>
          </div>
        </div>
        {{> iam_inline_policies entity_type = 'group'}}
        {{> iam_managed_policies}}
      </div>
    </script>
    <script>
      Handlebars.registerPartial("iam_group", $("#iam_Group-partial").html());
    </script>

    <!-- IAM policy partial -->
    <script id="iam_policy-partial" type="text/x-handlebars-template">
      <hr>
      <div>
        <div class="accordion item-margin">
          <h5 class="list-group-item-heading accordion-heading">{{PolicyName}}
            <a class="accordion-toggle" data-toggle="collapse" href="#iam_policy_details-{{ReportId}}">
              <span class="badge pull-right btn-info">Details</span>
            </a>
          </h5>
          <div id="iam_policy_details-{{ReportId}}" class="accordion-body collapse">
            <div class="accordion-inner">
              {{{displayPolicy PolicyDocument}}}
            </div>
          </div>
        </div>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("iam_policy", $("#iam_policy-partial").html());
    </script>

    <!-- IAM managed policies partial -->
    <script id="iam_managed_policies-partial" type="text/x-handlebars-template">
        <div class="list-group-item">
          {{#if ManagedPolicies}}
            <h4 class="list-group-item-heading">Managed Policies <span class="badge pull-right btn-info">{{count ManagedPolicies}}</span></h4>
          {{else}}
            <h4 class="list-group-item-heading">Managed Policies <span class="badge pull-right">{{count ManagedPolicies}}</span></h4>
          {{/if}}
          <ul class="no-bullet">
          {{#each ManagedPolicies}}
            <li class="list-group-item-text"><a href="javascript:showIAMManagedPolicy('{{this}}')">{{policy_friendly_name this}}</a></li>
          {{/each}}
          </ul>
        </div>
    </script>
    <script>
      Handlebars.registerPartial("iam_managed_policies", $("#iam_managed_policies-partial").html());
    </script>

    <!-- IAM inline policies partial -->
    <script id="iam_inline_policies-partial" type="text/x-handlebars-template">
        <div class="list-group-item">
          {{#if Policies}}
            <h4 class="list-group-item-heading">Inline Policies <span class="badge pull-right btn-info" id="iam_Users-user-inline-policy-{{user_name}}">{{count Policies}}</span></h4>
          {{else}}
            <h4 class="list-group-item-heading">Inline Policies <span class="badge pull-right">{{count Policies}}</span></h4>
          {{/if}}
          {{#each Policies}}
            {{policy_report_id this entity_type ../name @key}}
            {{> iam_policy PolicyName = @key}}
          {{/each}}
        </div>
    </script>
    <script>
      Handlebars.registerPartial("iam_inline_policies", $("#iam_inline_policies-partial").html());
    </script>


    <!-- IAM role partial -->
    <script id="iam_Role-partial" type="text/x-handlebars-template">
      <div class="list-group" id="iam_Role-details-{{Name}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{Name}}</h4>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Information</h4>
          <div class="list-group-item-text item-margin">Creation date: {{create_date}}</div>
        </div>
        <div class="list-group-item">
          <div class="accordion">
            <h4 class="list-group-item-heading accordion-heading">Instances
              <a class="accordion-toggle" data-toggle="collapse" href="#iam_role_instances-{{Name}}"><span class="badge pull-right btn-info">{{count_role_instances instance_profiles}}</span></a>
            </h4>
            <div id="iam_role_instances-{{Name}}" class="accordion-body collapse">
              <div class="accordion-inner">
                <ul class="no-bullet">
                  {{#each instance_profiles}}
                    {{#each instances}}
                      <li><a href="javascript:findAndShowEC2Object('regions.vpcs.instances', '{{this}}')">{{this}}</a></li>
                    {{/each}}
                  {{/each}}
                </ul>
              </div>
            </div>
          </div>
        </div>
        {{> iam_inline_policies entity_type = 'role'}}
        {{> iam_managed_policies}}
      </div>
    </script>
    <script>
      Handlebars.registerPartial("iam_role", $("#iam_Role-partial").html());
    </script>

    <!-- IAM user partial -->
    <script id="iam_User-partial" type="text/x-handlebars-template">
      <div class="list-group" id="iam_User-details-{{Name}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{Name}}</h4>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Information</h4>
          <div class="list-group-item-text item-margin">Creation date: {{CreateDate}}</div>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Authentication methods</h4>
          <p class="list-group-item-text item-margin">Password enabled: {{has_profiles? LoginProfile}}</p>
          <ul></ul>
          <p class="list-group-item-text item-margin">Multi-Factor enabled: <span id="iam_Users-no-mfa-{{Name}}">{{has_mfa? MFADevices}}</span></p>
          <ul class="item-margin">
          {{#each MFADevices}}
            <li class="list-group-item-text"> Serial number: {{SerialNumber}}</li>
          {{/each}}
          </ul>
          <p class="list-group-item-text item-margin">Access Keys: <span id="iam_Users-multiple-active-keys-{{Name}}">{{has_access_keys? AccessKeys}}</p><span>
          <ul class="item-margin">
          {{#each AccessKeys}}
            <li class="list-group-item-text"><span id="iam_Users-{{Status}}-key-no-rotation-{{../Name}}-{{AccessKeyId}}">{{AccessKeyId}}, {{Status}}, created on {{CreateDate}}</span></li>
          {{/each}}
          </ul>
          <p class="list-group-item-text item-margin">
            <span id="iam_Users-multiple-active-keys-{{Name}}" class="finding-hidden">
              <i class="glyphicon glyphicon-warning-sign"></i> Review the need for multiple active access keys
            </span>
          </p>
          <p class="list-group-item-text item-margin">
            <span id="iam_Users-password-and-key-{{Name}}" class="finding-hidden">
              <i class="glyphicon glyphicon-warning-sign"></i> Review the need for password-based and key-based authentication
            </span>
          </p>
          <p class="list-group-item-text item-margin">
            <span id="iam_Users-not-in-global-iam-group-{{Name}}" class="finding-hidden">
              <i class="glyphicon glyphicon-warning-sign"></i> User "{{Name}}" does not belong to the global/mandatory IAM group
            </span>
          </p>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Groups</h4>
          <ul class="no-bullet">
          {{#each Groups}}
            <li class="list-group-item-text"><a href="javascript:showIAMGroup('{{GroupName}}')">{{GroupName}}</a></li>
          {{/each}}
          </ul>
        </div>
        {{> iam_inline_policies entity_type = 'user' user_name = Name}}
        {{> iam_managed_policies}}
      </div>
    </script>
    <script>
      Handlebars.registerPartial("iam_user", $("#iam_User-partial").html());
    </script>

    <!-- RDS instance partial -->
    <script id="rds_instance-partial" type="text/x-handlebars-template">
      <div class="list-group" id="rds_instance-details-{{DBInstanceIdentifier}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{DBInstanceIdentifier}}</h4>
        </div>
        <div class="list-group-item">
          <h4>Information</h4>
          <ul>
            <li class="list-group-item-text">Region: {{region}}</li>
            <li class="list-group-item-text">Engine: {{Engine}}</li>
            <li class="list-group-item-text">Status: {{make_title DBInstanceStatus}}</li>
            <li class="list-group-item-text">Auto Minor Version Upgrade: <span id="rds_instances-no-minor-auto-upgrade-{{DBInstanceIdentifier}}">{{#if AutoMinorVersionUpgrade}} Enabled {{else}} Disabled {{/if}}</span></li>
            <li class="list-group-item-text">Multi Availability Zones: <span id="rds_instances-single-az-{{DBInstanceIdentifier}}">{{#if MultiAZ}} Enabled {{else}} Disabled {{/if}}</span></li>
            <li class="list-group-item-text">Instance Class: <span id="rds_instances-unscannable-instance-types-{{DBInstanceIdentifer}}"> {{DBInstanceClass}}<span></li>
            <li class="list-group-item-text">Created on: <span id="rds_instances-postgres-invalid-ssl-cert-{{DBInstanceIdentifier}}">{{InstanceCreateTime}}</span></li>
            <li class="list-group-item-tex">Backup retention period in days:
            <span id="rds_instances-backup-disabled-{{DBInstanceIdentifier}}">
            <span id="rds_instances-short-backup-retention-period-{{DBInstanceIdentifier}}">
              {{BackupRetentionPeriod}}
            </span>
            </span>
          </ul>
        </div>
        <div class="list-group-item">
          <h4>Network</h4>
          <ul>
            <li class="list-group-item-text">Endpoint: {{Endpoint.Address}}:{{Endpoint.Port}}</li>
            <li class="list-group-item-text">Publicly accessible: {{PubliclyAccessible}}</li>
          </ul>
        </div>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("rds_instance", $("#rds_instance-partial").html());
    </script>

    <!-- RDS security group partials -->
    <script id="rds_security_group-partial" type="text/x-handlebars-template">
      <div class="list-group" id="rds_security_group-details-{{name}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{name}}</h4>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Information</h4>
          <div class="list-group-item-text item-margin">Description: {{description}}</div>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Authorizations</h4>
          <ul>
            {{#each ec2_groups.owners}}
              {{#each groups}}
                <li class="list-group-item-text">
                  EC2 security group:
                  <a href="javascript:findAndShowEC2ObjectByAttr('regions.vpcs.security_groups', {'name': '{{this}}', 'owner_id': '{{@../key}}'})">{{this}} @ {{@../key}}</a>
                </li>
              {{/each}}
            {{/each}}
            {{#each ip_ranges}}
              <li class="list-group-item-text">IP: {{this}}</li>
            {{/each}}
          </ul>
        </div>
      </div>
    </script>
    <script>
        Handlebars.registerPartial("rds_security_group", $("#rds_security_group-partial").html());
    </script>

<!-- TODO: get parameter groups and flag stuff like : require_ssl false, enable_user_activity_logging false (check what that is) -->

    <!-- Redshift partials -->
    <!-- Redshift cluster partial -->
    <script id="redshift_cluster-partial" type="text/x-handlebars-template">
      <div class="list-group" id="redshift_cluster-details-{{id}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{id}}</h4>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Information</h4>
          <ul>
            <li class="list-group-item-text">Node Type: {{NodeType}}</li>
            <li class="list-group-item-text">Allow Version Upgrade: {{AllowVersionUpgrade}}</li>
            <li class="list-group-item-text">Automated Snapshot Retention Period: {{AutomatedSnapshotRetentionPeriod}}</li>
            <li class="list-group-item-text">Publicly Accessible: {{PubliclyAccessible}}</li>
            <li class="list-group-item-text">Created at: {{ClusterCreateTime}}</li>
            <li class="list-group-item-text">Availability Zone: {{AvailabilityZone}}</li>
            <li class="list-group-item-text">Encrypted: {{Encrypted}}</li>
            <li class="list-group-item-text">Cluster Parameter Groups:
              <ul>
                {{#each ClusterParameterGroups}}
                  <li>{{ParameterGroupName}}</li>
                {{/each}}
              </ul>
            </li>
          </ul>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Network</h4>
          <ul>
            <li class="list-group-item-text">Endpoint: {{Endpoint.Address}}:{{Endpoint.Port}}</li>
            <li class="list-group-item-text">Publicly accessible: {{PubliclyAccessible}}</li>
            <li class="list-group-item-text">VPC: {{VpcId}}</li>
            <li class="list-group-item-text">Subnet: {{ClusterSubnetGroupName}}</li>
            <li class="list-group-item-text">Security groups:
              <ul>
                {{#each VpcSecurityGroups}}
                  <li>{{VpcSecurityGroupId}}</li>
                {{/each}}
                {{#each ClusterSecurityGroups}}
                  <li>:: TODO ::</li>
                {{/each}}
              </ul>
            </li>
          </ul>
        </div>
        {{> accordion service_name = 'redshift' resource_type = 'cluster' resource_id = id member_type = 'Nodes' members = ClusterNodes member_partial_name = 'redshift_cluster_node'}}
      </div>
    </script>
    <script>
        Handlebars.registerPartial("redshift_cluster", $("#redshift_cluster-partial").html());
    </script>
    <!-- Redshift security group partials -->
    <script id="redshift_security_group-partial" type="text/x-handlebars-template">
      <div class="list-group" id="redshift_security_group-details-{{resource_key}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{resource_key}}</h4>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Information</h4>
          <div class="list-group-item-text item-margin">Description: {{Description}}</div>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Rules</h4>
          <ul>
            {{#if IPRanges}}
              <li class="list-group-item-text">IP addresses:</li>
              <ul>
                {{#each IPRanges}}
                  <li class="list-group-item-text">{{CIDRIP}} {{Status}}</li>
                {{/each}}
              </ul>
            {{/if}}
            {{#if EC2SecurityGroups}}
              <li class="list-group-item-text">EC2 security groups:</li>
              <ul>
                {{#each EC2SecurityGroups}}
                  <li class="list-group-item-text">{{EC2SecurityGroupName}} (AWS account ID {{UserId}})</li>
                {{/each}}
              </ul>
            {{/if}}
          </ul>
        </div>
      </div>
    </script>
    <script>
        Handlebars.registerPartial("redshift_security_group", $("#redshift_security_group-partial").html());
    </script>
    <!-- Redshift node partial -->
    <script id="redshift_cluster_node-partial" type="text/x-handlebars-template">
      {{NodeRole}}: {{PrivateIPAddress}} / {{PublicIPAddress}}
    </script>
    <script>
        Handlebars.registerPartial("redshift_cluster_node", $("#redshift_cluster_node-partial").html());
    </script>

    <!-- S3 partials -->
    <!-- S3 bucket partial -->
    <script id="s3_bucket-partial" type="text/x-handlebars-template">
      <div class="list-group" id="s3_bucket-details-{{Name}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{Name}}</h4>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Information</h4>
          <div class="list-group-item-text item-margin">Creation date: {{CreationDate}}</div>
          <div class="list-group-item-text item-margin">Logging: <span id="s3_buckets-logging-disabled-{{Name}}">{{has_logging? logging}}</span></div>
          <div class="list-group-item-text item-margin">Versioning: <span id="s3_buckets-versioning-disabled-{{Name}}">{{versioning_status}}</span></div>
          <div class="list-group-item-text item-margin">MFA Delete: <span id="s3_buckets-version_mfa_delete-disabled-{{Name}}">{{version_mfa_delete}}</span></div>
          <div class="list-group-item-text item-margin">Static website hosting: <span id="s3_buckets-static_website_hosting_enabled-{{Name}}">{{web_hosting}}</span></div>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Permissions</h4>
          <table class="table-striped" width="100%" >
            <tr>
              <td width="20%"></td>
              <td width="20%" class="text-center">List</td>
              <td width="20%" class="test-center">Upload/Delete</td>
              <td width="20%" class="text-center">View Permissions</td>
              <td width="20%" class="text-center">Edit Permissions</td>
            </tr>
            {{#each grantees}}
            <tr>
              <td width="20%" class="text-center">{{DisplayName}}</td>
              <td width="20%" class="text-center">
                <span id="s3_buckets-{{@key}}-read-{{../Name}}">{{{s3_grant_2_icon permissions.read}}}</td></span>
              </td>
              <td width="20%" class="text-center">
                <span id="s3_buckets-{{@key}}-read_acp-{{../Name}}">{{{s3_grant_2_icon permissions.write}}}</td></span>
              </td>
              <td width="20%" class="text-center">
                <span id="s3_buckets-{{@key}}-write-{{../Name}}">{{{s3_grant_2_icon permissions.read_acp}}}</td></span>
              </td>
              <td width="20%" class="text-center">
                <span id="s3_buckets-{{@key}}-write_acp-{{../Name}}">{{{s3_grant_2_icon permissions.write_acp}}}</td></span>
              </td>
            </tr>
            {{/each}}
          </table>
        </div>
        {{#if policy}}
          <div class="list-group-item">
            <div class="accordion">
              <h4 class="list-group-item-heading accordion-heading">Policy
                <a class="accordion-toggle" data-toggle="collapse" href="#s3_bucket_policy_details-{{fixBucketName @key}}">
                  <span class="badge pull-right btn-info">Details</span>
                </a>
              </h4>
              <div id="s3_bucket_policy_details-{{fixBucketName @key}}" class="accordion-body item-margin collapse">
                <div class="accordion-inner">
                  {{{displayPolicy policy}}}
                </div>
              </div>
            </div>
          </div>
        {{/if}}
        {{#if keys}}
          <div class="list-group-item">
            <div class="accordion">
              <h4 class="list-group-item-heading accordion-heading">Keys
                <a class="accordion-toggle" data-toggle="collapse" href="#s3_bucket_keys-{{@key}}">
                  <span class="badge pull-right btn-info">{{count keys}}<span>
                </a>
              </h4>
              <div id="s3_bucket_keys-{{@key}}" class="accordion-body item-margin collapse">
                <div class="accordion-inner">
                  <table class="table-striped" width="100%" >
                    <tr>
                      <td width="80%">Name</td>
                      <td width="10%" class="text-center">Encrypted</td>
                      <td width="10%" class="text-center">Perms</td>
                    </tr>
                    {{#each keys}}
                    <tr>
                      <td width="80%"><a href="javascript:showS3Object('{{../Name}}', '{{@key}}')">{{@key}}</a></td>
                      <td width="10%" class="text-center">
                        <span id="s3_buckets-unencrypted-s3-objects-{{../Name}}-{{@key}}">
                          {{{good_bad_icon "unencrypted-s3-objects" ../Name @key}}}
                        </span>
                      </td>
                      <td width="10%" class="text-center">
                        <span id="s3_buckets-object-perms-mismatch-bucket-perms-{{../Name}}-{{@key}}">
                          {{{good_bad_icon "object-perms-mismatch-bucket-perms" ../Name @key}}}
                        </span>
                      </td>
                    </tr>
                    {{/each}}
                  </table>
                </div>
              </div>
            </div>
          </div>
        {{/if}}
      </div>
    </script>
    <script>
      Handlebars.registerPartial("s3_bucket", $("#s3_bucket-partial").html());
    </script>

    <!-- S3 object partial -->
    <script id="s3_object-partial" type="text/x-handlebars-template">
      <div class="list-group" id="s3_object-details-{{Name}}">
        <div class="list-group-item active">
          <h4 class="list-group-item-heading">{{bucket_name}}/{{Name}}</h4>
        </div>
        <div class="list-gorup-item">
          <h4 class="list-group-item-heading">Information</h4>
          <div class="list-group-item-text">
            <ul class="no-bullet">
              <li>Server-side encryption: {{{good_bad_icon "unencrypted-s3-objects" bucket_name name}}}</li>
              <li>Permissions match bucket's: {{{good_bad_icon "object-perms-mismatch-bucket-perms" bucket_name name}}}</li>
            </ul>
          </div>
        </div>
        <div class="list-group-item">
          <h4 class="list-group-item-heading">Permissions</h4>
          <table class="table-striped" width="100%" >
            <tr>
              <td width="20%"></td>
              <td width="20%" class="text-center">Read access</td>
              <td width="20%" class="text-center">Read permissions</td>
              <td width="20%" class="text-center">Write access</td>
              <td width="20%" class="text-center">Write permissions</td>
            </tr>
            {{#each grants}}
              <tr>
                <td width="20%">{{@key}}</td>
                <td width="20%" class="text-center">
                  <span id="s3_buckets-{{Name}}-read-{{../name}}">{{{s3_grant_2_icon this.read}}}</td></span>
                </td>
                <td width="20%" class="text-center">
                  <span id="s3_buckets-{{Name}}-read_acp-{{../name}}">{{{s3_grant_2_icon this.read_acp}}}</td></span>
                </td>
                <td width="20%" class="text-center">
                  <span id="s3_buckets-{{Name}}-write-{{../name}}">{{{s3_grant_2_icon this.write}}}</td></span>
                </td>
                <td width="20%" class="text-center">
                  <span id="s3_buckets-{{Name}}-write_acp-{{../name}}">{{{s3_grant_2_icon this.write_acp}}}</td></span>
                </td>
              </tr>
            {{/each}}
          </table>
        </div>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("s3_object", $("#s3_object-partial").html());
    </script>


    <!-- Close popup button -->
    <script id="close_button-template" type="text/x-handlebars-template">
      <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
    </script>
    <script>
      var close_button_template = Handlebars.compile($("#close_button-template").html());
    </script>

    <!-- Single EC2 instance template -->
    <script id="single_ec2_instance-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> ec2_instance}}
    </script>
    <script>
        var single_ec2_instance_template = Handlebars.compile($("#single_ec2_instance-template").html());
    </script>

    <!-- Single EC2 VPC template -->
    <script id="single_ec2_vpc-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> ec2_vpc}}
    </script>
    <script>
        var single_ec2_vpc_template = Handlebars.compile($("#single_ec2_vpc-template").html());
    </script>

    <!-- Single EC2 Network ACL template -->
    <script id="single_ec2_network_acl-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> ec2_network_acl}}
    </script>
    <script>
        var single_ec2_network_acl_template = Handlebars.compile($("#single_ec2_network_acl-template").html());
    </script>

    <!-- Single EC2 security group template -->
    <script id="single_ec2_security_group-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> ec2_security_group}}
    </script>
    <script>
        var single_ec2_security_group_template = Handlebars.compile($("#single_ec2_security_group-template").html());
    </script>

    <!-- Single IAM group template -->
    <script id="single_iam_Group-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> iam_group}}
    </script>
    <script>
        var single_iam_group_template = Handlebars.compile($("#single_iam_Group-template").html());
    </script>

    <!-- Single IAM policy template -->
    <script id="single_iam_policy-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> iam_policy}}
        <hr>
    </script>
    <script>
        var single_iam_policy_template = Handlebars.compile($("#single_iam_policy-template").html());
    </script>

    <!-- Single IAM role template -->
    <script id="single_iam_Role-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> iam_role}}
    </script>
    <script>
        var single_iam_role_template = Handlebars.compile($("#single_iam_Role-template").html());
    </script>

    <!-- Single IAM user template -->
    <script id="single_iam_User-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> iam_user}}
    </script>
    <script>
        var single_iam_user_template = Handlebars.compile($("#single_iam_User-template").html());
    </script>

    <!-- Single S3 bucket template -->
    <script id="single_s3_bucket-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> s3_bucket}}
    </script>
    <script>
        var single_s3_bucket_template = Handlebars.compile($("#single_s3_bucket-template").html());
    </script>

    <!-- Single S3 object template -->
    <script id="single_s3_object-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> s3_object}}
    </script>
    <script>
      var single_s3_object_template = Handlebars.compile($("#single_s3_object-template").html());
    </script>

    <!-- Fixed navbar -->
    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <span class="navbar-brand">AWS Scout</span>
        </div>
        <div class="navbar-collapse collapse">
          <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a href="javascript:show_cloudtrail()" class="dropdown-toggle" data-toggle="dropdown"><span id="cloudtrail_dropdown">CloudTrail</span><b class="caret"></b></a>
              <ul class="dropdown-menu" id="cloudtrail_violations-list">
                <li class="dropdown-header">CloudTrail config</li>
                <li id="cloudtrail_load_button"><a href="javascript:load_config('cloudtrail')">Load</a></li>
                <script id="cloudtrail_violation-list-template" type="text/x-handlebars-template">
                  <li class="dropdown-header">CloudTrail config</li>
                  <li><a href="javascript:list_generic('cloudtrail_region')">Trails</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Summaries</li>
                  <li><a href="javascript:list_generic('cloudtrail_dashboard')">Dashboard</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Security risks</li>
                  {{#each items}}
                    {{> finding_menu_item}}
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a href="javascript:show_ec2()" class="dropdown-toggle" data-toggle="dropdown"><span id="ec2_dropdown">EC2</span><b class="caret"></b></a>
              <ul class="dropdown-menu" id="ec2_violations-list">
                <li class="dropdown-header">EC2 config</li>
                <li id="ec2_load_button"><a href="javascript:load_config('ec2')">Load</a></li>
                <script id="ec2_violation-list-template" type="text/x-handlebars-template">
                  <li class="dropdown-header">EC2 config</li>
                  <li><a href="javascript:list_generic('ec2_elb')">ELBs</a></li>
                  <li><a href="javascript:list_generic('ec2_instance')">Instances</a></li>
                  <li><a href="javascript:list_generic('ec2_vpc')">VPCs</a></li>
                  <li><a href="javascript:list_generic('ec2_network_acl')">Network ACLs</a></li>
                  <li><a href="javascript:list_generic('ec2_security_group')">Security Groups</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Summaries</li>
                  <li><a href="javascript:list_generic('ec2_dashboard')">Dashboard</a></li>
                  <li><a href="javascript:list_generic('ec2_attack_surface')">External Attack Surface</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Security risks</li>
                  {{#each items}}
                    {{> finding_menu_item}}
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a href="javascript:show_iam()" class="dropdown-toggle" data-toggle="dropdown"><span id="iam_dropdown">IAM</span><b class="caret"></b></a>
              <ul class="dropdown-menu" id="iam_violations-list">
                <li class="dropdown-header">IAM config</li>
                <li id="iam_load_button"><a href="javascript:load_config('iam')">Load</a></li>
                <script id="iam_violation-list-template" type="text/x-handlebars-template">
                  <li class="dropdown-header">IAM config</li>
                  <li><a href="javascript:list_generic('iam_Group')">Groups</a></li>
                  <li><a href="javascript:list_generic('iam_Role')">Roles</a></li>
                  <li><a href="javascript:list_generic('iam_CredentialReport')">Root account</a></li>
                  <li><a href="javascript:list_generic('iam_User')">Users</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Summaries</li>
                  <li><a href="javascript:list_generic('iam_dashboard')">Dashboard</a></li>
                  <li><a href="javascript:list_generic('iam_Permission')">Permissions</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Security risks</li>
                  {{#each items}}
                    {{> finding_menu_item}}
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a href="javascript:show_rds()" class="dropdown-toggle" data-toggle="dropdown"><span id="rds_dropdown">RDS</span><b class="caret"></b></a>
              <ul class="dropdown-menu" id="rds_violations-list">
                <li class="dropdown-header">RDS config</li>
                <li id="rds_load_button"><a href="javascript:load_config('rds')">Load</a></li>
                <script id="rds_violation-list-template" type="text/x-handlebars-template">
                  <li class="dropdown-header">RDS config</li>
                  <li><a href="javascript:list_generic('rds_instance')">Instances</a></li>
                  <li><a href="javascript:list_generic('rds_security_group')">Security Groups</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Summaries</li>
                  <li><a href="javascript:list_generic('rds_dashboard')">Dashboard</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Security risks</li>
                  {{#each items}}
                    {{> finding_menu_item}}
                  {{/each}}
                </script>
              </ul>
            </li>
            <!-- TODO: stop duplicating this code... automate it based on the data structure -->
            <li class="dropdown">
              <a href="javascript:show_redshift()" class="dropdown-toggle" data-toggle="dropdown"><span id="redshift_dropdown">Redshift</span><b class="caret"></b></a>
              <ul class="dropdown-menu" id="redshift_violations-list">
                <li class="dropdown-header">Redshift config</li>
                <li><a href="javascript:load_config('redshift')">Load</a></li>
                <script id="redshift_violation-list-template" type="text/x-handlebars-template">
                  <li class="dropdown-header">Redshift config</li>
                  <li><a href="javascript:list_generic('redshift_cluster')">Clusters</a></li>
                  <li><a href="javascript:list_generic('redshift_security_group')">Security Groups</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Summaries</li>
                  <li><a href="javascript:list_generic('redshift_dashboard')">Dashboard</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Security risks</li>
                  {{#each items}}
                    {{> finding_menu_item}}
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a href="javascript:show_s3()" class="dropdown-toggle" data-toggle="dropdown"><span id="s3_dropdown">S3</span><b class="caret"></b></a>
              <ul class="dropdown-menu" id="s3_violations-list">
                <li class="dropdown-header">S3 config</li>
                <li><a href="javascript:load_config('s3')">Load</a></li>
                <script id="s3_violation-list-template" type="text/x-handlebars-template">
                  <li class="dropdown-header">S3 config</li>
                  <li><a href="javascript:list_generic('s3_bucket')">Buckets</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Summaries</li>
                  <li><a href="javascript:list_generic('s3_dashboard')">Dashboard</a></li>
                  <li class="divider"></li>
                  <li class="dropdown-header">Security risks</li>
                  {{#each items}}
                    {{> finding_menu_item}}
                  {{/each}}
                </script>
              </ul>
            </li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Regions<b class="caret"></b></a>
              <ul class="dropdown-menu" id="region-filters-list">
                <script id="region-filter-list-template" type="text/x-handlebars-template">
                  <li id="{{finding_entity keyword "region"}}-filter-select_none"><a href="javascript:clear_all_regions('{{keyword}}')">Hide all</a></li>
                  <li id="{{finding_entity keyword "region"}}-filter-select_all"><a href="javascript:select_all_regions('{{keyword}}')">Select all</a></li>
                  {{#each items}}
                    <li id="{{finding_entity ../keyword "region"}}-filter-{{@key}}"><a href="javascript:toggle_region('{{../keyword}}', '{{@key}}')"><i id="{{finding_entity ../keyword "region"}}-filtericon-{{@key}}" class="glyphicon glyphicon-check""></i> {{@key}}</a></li>
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Filters<b class="caret"></b></a>
              <ul class="dropdown-menu" id="filters-list">
                <script id="filter-list-template" type="text/x-handlebars-template">
                  {{#each items}}
                    <li id="{{finding_entity keyword_prefix entity}}-filter-{{@key}}"><a href="javascript:toggle_filter(aws_info['{{keyword_prefix}}', '{{@key}}')"><i id="{{finding_entity keyword_prefix entity}}-filtericon-{{@key}}" class="glyphicon glyphicon-unchecked""></i> {{description}} ({{items.length}})</a></li>
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Help<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="javascript:about()">About AWS Scout2</a></li>
              </ul>
            </li>
          </ul>
          </div>
        </div><!--/.nav-collapse -->
      </div>

    </div>

    <div class="container theme-showcase" id="container-user">

      <div class="page-header">
      </div>

      <!-- Overlay divs used to show entity details in pop up -->
      <div id="overlay-background" class="overlay-bg"></div>
      <div id="overlay-details" class="overlay col-sm-6"></div>

      <!-- Section Title -->
      <div id="section_title-div">
          <h2 id="section_title-h2"></h2>
      </div>

      <!-- Dashboards -->
      <div class="row" id="cloudtrail_dashboards-row">
        <div class="col-sm-12" id="cloudtrail_dashboards-list">
          <script id="cloudtrail_dashboard-list-template" type="text/x-handlebars-template">
            {{> dashboard service_name = 'cloudtrail'}}
          </script>
        </div>
      </div>
      <div class="row" id="ec2_dashboards-row">
        <div class="col-sm-12" id="ec2_dashboards-list">
          <script id="ec2_dashboard-list-template" type="text/x-handlebars-template">
            {{> dashboard service_name = 'ec2'}}
          </script>
        </div>
      </div>
      <div class="row" id="iam_dashboards-row">
        <div class="col-sm-12" id="iam_dashboards-list">
          <script id="iam_dashboard-list-template" type="text/x-handlebars-template">
            {{> dashboard service_name = 'iam'}}
          </script>
        </div>
      </div>
      <div class="row" id="rds_dashboards-row">
        <div class="col-sm-12" id="rds_dashboards-list">
          <script id="rds_dashboard-list-template" type="text/x-handlebars-template">
            {{> dashboard service_name = 'rds'}}
          </script>
        </div>
      </div>
      <div class="row" id="redshift_dashboards-row">
        <div class="col-sm-12" id="redshift_dashboards-list">
          <script id="redshift_dashboard-list-template" type="text/x-handlebars-template">
            {{> dashboard service_name = 'redshift'}}
          </script>
        </div>
      </div>
      <div class="row" id="s3_dashboards-row">
        <div class="col-sm-12" id="s3_dashboards-list">
          <script id="s3_dashboard-list-template" type="text/x-handlebars-template">
            {{> dashboard service_name = 's3'}}
          </script>
        </div>
      </div>

      <!-- Template for CloudTrail -->
      <div class="row" id="cloudtrail_regions-row">
        <div class="col-sm-4" id="cloudtrail_regions-list">
          <script id="cloudtrail_region-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('cloudtrail_region')">Show all<span class="badge pull-right">{{count_in 'cloudtrail' 'regions'}}</span></a></li>
            </ul>
            {{#each items}}
              <ul class="list-group" id="cloudtrail_region-list-{{@key}}">
                <li class="list-group-item active">
                  {{@key}} <span class="badge pull-right">{{count_ec2_in_region @key "vpcs.instances"}} instances </span>
                </li>
                {{#each trails}}
                  <div class="list-group-item list-sub-element">
                    <a href="javascript:browseTo('cloudtrail_region', '{{../name}}')">{{../name}}</a>
                  </div>
                {{else}}
                  <div class="list-group-item list-sub-element">
                    <span id="cloudtrail_regions-Service disabled-{{@key}}">CloudTrail disabled</span>
                  </div>
                {{/each}}
              </ul>
            {{/each}}
          </script>
        </div>
        <div class="col-sm-8" id="cloudtrail_regions-details">
          <script id="cloudtrail_region-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            {{> cloudtrail_region}}
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for network attack surface -->
      <div class="row" id="ec2_attack_surfaces-row">
        <div id="ec2_attack_surfaces-list">
          <script id="ec2_attack_surface-list-template" type="text/x-handlebars-template">
            <div class="list-group">
              <div class="row list-group-item active">
                <div class="col-sm-4"><h4>Public IP address</h4></div>
                <div class="col-sm-4"><h4>Open ports</h4></div>
                <div class="col-sm-4 pull-right"><h4><form>Filter by external IP:</h4> <input type="text" id="ec2_attack_surface_item_filter" onkeyup="filter_items('span', 'ec2_attack_surface_item')"></form></div>
              </div>
              {{#each items}}
                <div class="row list-group-item">
                  <div class="col-sm-4">{{@key}}</div>
                  <div class="col-sm-8">
                    <ul>
                    {{#each protocols ip = @key}}
                      <li class="list-group-item-text">{{@key}}</li>
                      <ul>
                      {{#each ports}}
                        <li>{{@key}}</li>
                        {{> ip_grants items = cidrs}}
                      {{/each}}
                      </ul>
                    {{/each}}
                    </ul>
                  </div>
                </div>
              {{/each}}
            </div>
          </script>
        </div>
      </div>

      <!-- Template for EC2 ELBs -->
      <div class="row" id="ec2_elbs-row">
        <div class="col-sm-4" id="ec2_elbs-list">
          <script id="ec2_elb-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('ec2_elb')">Show all<span class="badge pull-right">{{count_in "ec2" "regions.elbs"}}</span></a></li>
            </ul>
            {{#each items}}
             {{#if elbs}}
              <ul class="list-group">
                <li class="list-group-item active">{{@key}}</li>
                {{#each elbs}}
                  <div class="list-group-item list-sub-element" id="ec2_elb-list-{{@key}}"><a href="javascript:browseTo('ec2_elb', '{{@key}}')">{{@key}}</a></div>
                {{/each}}
              </ul>
             {{/if}}
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="ec2_elbs-details">
          <script id="ec2_elb-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            {{#each elbs}}
              {{> ec2_elb}}
            {{/each}}
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for EC2 security groups -->
      <div class="row" id="ec2_security_groups-row">
        <div class="col-sm-4" id="ec2_security_groups-list">
          <script id="ec2_security_group-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('ec2_security_group')">Show all<span class="badge pull-right">{{count_in "ec2" "regions.vpcs.security_groups"}}</span></a></li>
            </ul>
            {{#each items}}
              <div id="ec2_region-list-{{@key}}">
                {{#if vpcs}}
                  <ul class="list-group">
                    <li class="list-group-item active">{{@key}}</li>
                    {{#each vpcs}}
                      <div class="list-group-item list-sub-element">
                        {{Name}}
                        {{#each security_groups}}
                          <div class="list-group-item-text list-sub-element" id="security_group-list-{{id}}"><a href="javascript:browseTo('ec2_security_group', '{{id}}')">{{name}}</a></div>
                        {{/each}}
                      </div>
                    {{/each}}
                  </ul>
                {{/if}}
              </div>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="ec2_security_groups-details">
          <script id="ec2_security_group-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            <div id="ec2_region-details-{{@key}}">
              {{#each vpcs}}
                {{#each security_groups}}
                  {{> ec2_security_group region=@../../key vpc=@../key}}
                {{/each}}
              {{/each}}
            </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for EC2 network ACLs -->
      <div class="row" id="ec2_network_acls-row">
        <div class="col-sm-4" id="ec2_network_acls-list">
          <script id="ec2_network_acl-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('ec2_network_acl')">Show all<span class="badge pull-right">{{count_in "ec2" "regions.vpcs.network_acls"}}</span></a></li>
            </ul>
            {{#each items}}
              <div id="ec2_region-list-{{@key}}">
                {{#if vpcs}}
                  <ul class="list-group">
                    <li class="list-group-item active">{{@key}}</li>
                    {{#each vpcs}}
                      <div class="list-group-item list-sub-element">
                        {{Name}}
                        {{#if network_acls}}
                          {{#each network_acls}}
                            <div class="list-group-item-text list-sub-element"><a href="javascript:browseTo('ec2_network_acl', '{{@key}}')">{{@key}}</a></div>
                          {{/each}}
                        {{/if}}
                      </div>
                    {{/each}}
                  </ul>
                {{/if}}
              </div>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="ec2_network_acls-details">
          <script id="ec2_network_acl-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            <div id="ec2_region-details-{{@key}}">
              {{#each vpcs}}
                {{#each network_acls}}
                  {{> ec2_network_acl RegionName = @../../key}}
                {{/each}}
              {{/each}}
            </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for EC2 VPCs -->
      <div class="row" id="ec2_vpcs-row">
        <div class="col-sm-4" id="ec2_vpcs-list">
          <script id="ec2_vpc-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('ec2_vpc')">Show all<span class="badge pull-right">{{count_in "ec2" "regions.vpcs"}}</span></a></li>
            </ul>
            {{#each items}}
              <div id="ec2_region-list-{{@key}}">
                {{#if vpcs}}
                  <ul class="list-group">
                    <li class="list-group-item active">{{@key}}</li>
                    {{#each vpcs}}
                        <div class="list-group-item-text list-sub-element" id="ec2_instance-list-{{id}}"><a href="javascript:browseTo('ec2_vpc', '{{id}}')">{{Name}}</a></div>
                    {{/each}}
                  </ul>
                {{/if}}
              </div>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="ec2_vpcs-details">
          <script id="ec2_vpc-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            <div id="ec2_region-details-{{@key}}">
              {{#each vpcs}}
                    {{> ec2_vpc region=../name}}
              {{/each}}
            </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for EC2 instances -->
      <div class="row" id="ec2_instances-row">
        <div class="col-sm-4" id="ec2_instances-list">
          <script id="ec2_instance-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('ec2_instance')">Show all<span class="badge pull-right">{{count_in "ec2" "regions.vpcs.instances"}}</span></a></li>
            </ul>
            {{#each items}}
              <div id="ec2_region-list-{{@key}}">
                {{#if vpcs}}
                  <ul class="list-group">
                    <li class="list-group-item active">{{@key}}</li>
                    {{#each vpcs}}
                      <div class="list-group-item list-sub-element">
                        {{Name}}
                        {{#each instances}}
                          <div class="list-group-item-text list-sub-element" id="ec2_instance-list-{{id}}"><a href="javascript:browseTo('ec2_instance', '{{InstanceId}}')">{{Name}}</a></div>
                        {{/each}}
                      </div>
                    {{/each}}
                  </ul>
                {{/if}}
              </div>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="ec2_instances-details">
          <script id="ec2_instance-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            <div id="ec2_region-details-{{@key}}">
              {{#each vpcs}}
                {{#each instances}}
                  {{> ec2_instance region=../../name}}
                {{/each}}
              {{/each}}
            </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for IAM groups -->
      <div class="row" id="iam_Groups-row">
        <div class="col-sm-4">
          <ul class="list-group" id="iam_Groups-list">
            <script id="iam_Group-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('iam_Group')">Show all <span class="badge pull-right">{{count items}}</span></a></li>
            {{#each items}}
              <li class="list-group-item" id="iam_Group-list-{{Name}}">
                <a href="javascript:browseTo('iam_Group','{{Name}}')">{{Name}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="iam_Groups-details">
          <script id="iam_Group-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            {{> iam_group}}
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for IAM permissions -->
      <div class="row" id="iam_Permissions-row">
        <div id="iam_Permissions-list"></div>
          <script id="iam_Permission-list-template" type="text/x-handlebars-template">
          {{#each items}}
            <div class="list-group">
              <div class="row list-group-item active">
                <div class="col-sm-4"><h4>{{@key}} Permission</h4></div>
                <div class="col-sm-8"><h4>Details</h4></div>
              </div>
              {{#each this}}
                <div class="row list-group-item" id="iam_Permission-details-{{@key}}">
                  <div class="col-sm-4">{{@key}}:</div>
                  <div class="col-sm-8">
                    {{#each this}}
                      {{addMember 'type' @key}}
                      <div class="list-group-item-text">{{make_title @key}}:</div>
                      <ul>
                        {{#each this}}
                          {{#ifShow @key 'type'}}
                            <li class="list-group-item-text">{{make_title @key}}:</li>
                            <ul>
                              {{#each this}}
                                {{addMember 'name' @key}}
                                <li class="list-group-item-text"><a href="javascript:{{entity_details_callback ../../../type}}('{{@key}}')">{{@key}}</a></li>
                                <ul>
                                  {{#each this}}
                                    {{#ifShow @key 'name'}}
                                      <li class="list-group-item-text">{{make_title @key}}s</li>
                                      <ul class="no-bullet">
                                        {{#each this}}
                                          {{addMember 'Resource' @key}}
                                          {{#each InlinePolicies}}
                                            <li>
                                              {{../Resource}} granted in <a href="javascript:showIAMInlinePolicy('{{../../../../../../../type}}', '{{../../../../name}}', '{{@key}}')">{{@key}}</a>
                                              {{#if condition}}
                                                <ul class="no-bullet">
                                                  <li class="list-group-item-text">Condition: {{condition}}</li>
                                                </ul>
                                              {{/if}}
                                            </li>
                                          {{/each}}
                                          {{#each ManagedPolicies}}
                                            <li>
                                              {{../Resource}} granted in <a href="javascript:showIAMManagedPolicy('{{@key}}')">{{policy_friendly_name @key}}</a>
                                              {{#if condition}}
                                                <ul class="no-bullet">
                                                  <li class="list-group-item-text">Condition: {{condition}}</li>
                                                </ul>
                                              {{/if}}
                                            </li>
                                          {{/each}}
                                        {{/each}}
                                      </ul>
                                    {{/ifShow}}
                                  {{/each}}
                                </ul>
                              {{/each}}
                            </ul>
                          {{/ifShow}}
                        {{/each}}
                      </ul>
                    {{/each}}
                  </div>
                </div>
              {{/each}}
            </div>
          {{/each}}
          </script>
      </div><!-- /.row -->

      <!-- Template for IAM root account overview -->
      <div class="row" id="iam_CredentialReports-row">
        <div id="iam_CredentialReports-list"></div>
          <script id="iam_CredentialReport-list-template" type="text/x-handlebars-template">
            <div class="list-group" id="iam_CredentialReport-details-">
              <div class="list-group-item active">
                <h4 class="list-group-item-heading">AWS root account</h4>
              </div>
              <div class="list-group-item">
                <div class="list-group-item-text item-margin">Creation date: {{items.user_creation_time}}</div>
                <div class="list-group-item-text item-margin">Password last used: <span id="iam_CredentialReport-root-active-password-">{{items.password_last_used}}</span></div>
                <div class="list-group-item-text item-margin">MFA enabled: <span id="iam_CredentialReport-root-no-mfa-">{{items.mfa_active}}</span></div>
                <div class="list-group-item-text item-margin">Access key 1 active: <span id="iam_CredentialReport-root-active-key-access_key_1_active">{{items.access_key_1_active}}</span></div>
                <div class="list-group-item-text item-margin">Access key 2 active: <span id="iam_CredentialReport-root-active-key-access_key_2_active">{{items.access_key_2_active}}</span></div>
                <div class="list-group-item-text item-margin">Signing cert 1 active: {{items.cert_1_active}}</div>
                <div class="list-group-item-text item-margin">Signing cert 2 active: {{items.cert_2_active}}</div>
              </div>
            </div>
          </script>
      </div><!-- /.row -->

      <!-- Template for IAM roles -->
      <div class="row" id="iam_Roles-row">
        <div class="col-sm-3">
          <ul class="list-group" id="iam_Roles-list">
            <script id="iam_Role-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('iam_Role')">Show all <span class="badge pull-right">{{count items}}</span></a></li>
            {{#each items}}
              <li class="list-group-item" id="iam_Role-list-{{Name}}">
                <a href="javascript:browseTo('iam_Role','{{Name}}')">{{Name}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="iam_Roles-details">
          <script id="iam_Role-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            {{> iam_role}}
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for IAM users -->
      <div class="row" id="iam_Users-row">
        <div class="col-sm-4">
          <ul class="list-group" id="iam_Users-list">
            <script id="iam_User-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('iam_User')">Show all <span class="badge pull-right">{{count items}}</span></a></li>
            {{#each items}}
              <li class="list-group-item" id="iam_User-list-{{Name}}">
                <a href="javascript:browseTo('iam_User','{{Name}}')">{{Name}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="iam_Users-details">
          <script id="iam_User-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            {{> iam_user}}
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for RDS instances -->
      <div class="row" id="rds_instances-row">
        <div class="col-sm-4" id="rds_instances-list">
          <script id="rds_instance-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('rds_instance')">Show all<span class="badge pull-right">{{count_in "rds" "regions.instances"}}</span></a></li>
            </ul>
            {{#each items}}
              <ul class="list-group" id="rds_region-list-{{@key}}">
                <li class="list-group-item active">{{@key}}</li>
                {{#each instances}}
                  <div class="list-group-item list-sub-element">
                    <div class="list-group-item-text list-sub-element" id="rds_instance-list-{{@key}}"><a href="javascript:browseTo('rds_instance', '{{@key}}')">{{@key}}</a></div>
                  </div>
                {{/each}}
              </ul>
            {{/each}}
          </script>
        </div>
        <div class="col-sm-8" id="rds_instances-details">
          <script id="rds_instance-detail-template" type="text/x-handlebars-template">
            {{#each items}}
              <div id="rds_region-details-{{@key}}">
                {{#each instances}}
                  {{> rds_instance region=../name}}
                {{/each}}
              </div>
            {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for RDS security groups -->
      <div class="row" id="rds_security_groups-row">
        <div class="col-sm-4" id="rds_security_groups-list">
          <script id="rds_security_group-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('rds_security_group')">Show all<span class="badge pull-right">{{count_in "rds" "regions.security_groups"}}</span></a></li>
            </ul>
            {{#each items}}
              <ul class="list-group" id="rds_region-list-{{@key}}">
                <li class="list-group-item active">{{@key}}</li>
                {{#each security_groups}}
                  <div class="list-group-item list-sub-element">
                    <div class="list-group-item-text list-sub-element" id="rds_security_group-list-{{name}}"><a href="javascript:browseTo('rds_security_group', '{{name}}')">{{name}}</a></div>
                  </div>
                {{/each}}
              </ul>
            {{/each}}
          </script>
        </div>
        <div class="col-sm-8" id="rds_security_groups-details">
          <script id="rds_security_group-detail-template" type="text/x-handlebars-template">
            {{#each items}}
              <div id="rds_region-details-{{@key}}">
                {{#each security_groups}}
                  {{> rds_security_group region=../../name }}
                {{/each}}
              </div>
            {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for Redshift security groups -->
      <div class="row" id="redshift_security_groups-row">
        <div class="col-sm-4" id="redshift_security_groups-list">
          <script id="redshift_security_group-list-template" type="text/x-handlebars-template">
            {{> region_vpc service_name = 'redshift' resource_type = 'security_groups' regions = items partial_name = 'region_vpc_link' is_menu = true}}
          </script>
        </div>
        <div class="col-sm-8" id="redshift_security_groups-details">
          <script id="redshift_security_group-detail-template" type="text/x-handlebars-template">
            {{> region_vpc service_name = 'redshift' resource_type = 'security_groups' regions = items partial_name = 'redshift_security_group'}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for Redshift clusters -->
      <!-- TODO: look into making this generic... -->
      <div class="row" id="redshift_clusters-row">
        <div class="col-sm-4" id="redshift_clusters-list">
          <script id="redshift_cluster-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('redshift_cluster')">Show all<span class="badge pull-right">{{count_in "redshift" "regions.clusters"}}</span></a></li>
            </ul>
            {{#each items}}
              <ul class="list-group" id="redshift_region-list-{{@key}}">
                <li class="list-group-item active">{{@key}}</li>
                {{#each clusters}}
                  <div class="list-group-item list-sub-element" id="redshift_cluster-list-{{@key}}"><a href="javascript:browseTo('redshift_cluster', '{{@key}}')">{{@key}}</a></div>
                {{/each}}
              </ul>
            {{/each}}
          </script>
        </div>
        <div class="col-sm-8" id="redshift_clusters-details">
          <script id="redshift_cluster-detail-template" type="text/x-handlebars-template">
            {{#each items}}
              <div id="redshift_region-details-{{@key}}">
                {{#each clusters}}
                  {{> redshift_cluster region = @../key id = @key}}
                {{/each}}
              </div>
            {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for S3 buckets -->
      <div class="row" id="s3_buckets-row">
        <div class="col-sm-4">
          <ul class="list-group" id="s3_buckets-list">
            <script id="s3_bucket-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('s3_bucket')">Show all <span class="badge pull-right">{{count items}}</span></a></li>
            {{#each items}}
              <li class="list-group-item" id="s3_bucket-list-{{@key}}">
                <a href="javascript:browseTo('s3_bucket','{{@key}}')">{{@key}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="s3_buckets-details">
          <script id="s3_bucket-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            {{> s3_bucket}}
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <div class="row" id="about-row">
        <div class="list-group">
          <div class="row list-group-item active">
            About
          </div>
          <div class="row list-group-item">
            <p>&nbsp;</p>
            <p>AWS Scout2 is an open-source security tool release by <a href="https://www.isecpartners.com" target="_blank">iSEC Partners</a>.</p>
            <p>&nbsp;</p>
            <p>Use the top navigation bar to review the configuration of the
            supported AWS services. For more information about Scout2, please
            check out the project's page on
            <a href="https://github.com/iSECPartners/Scout2" target="_blank">Github</a>
            and the project's website at
            <a href="https://isecpartners.github.io/Scout2/" target="_blank">https://isecpartners.github.io/Scout2/</a>.
            <p>&nbsp;</p>
            The AWS documentation is available at
            <a href="https://aws.amazon.com/documentation" target="_blank">https://aws.amazon.com/documentation</a>.
            </p>
          </div>
        </div>
      </div>

      <div class="row" id="please_wait-row">
        <div class="list-group">
          <div class="row list-group-item active">
            Please wait
          </div>
          <div class="row list-group-item">
            <p>&nbsp;</p>
            <p>Loading data, this may take a while...</p>
            <p>&nbsp;</p>
          </div>
        </div>
      </div>


    </div> <!-- /container -->

    <!-- Include all AWS services configs -->
    <script src="inc-awsconfig/aws_config.js"></script>

    <!-- Bootstrap core JavaScript, placed at the end of the document so the pages load faster -->
    <script src="inc-bootstrap/js/bootstrap.min.js"></script>

    <!-- Hide the please wait message -->
    <script>$('#please_wait-row').hide();</script>

  </body>
</html>
