<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>AWS Scout2 Report</title>

    <!-- Bootstrap core CSS -->
    <link href="inc-bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="inc-bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <!-- jQuery -->
    <script src="inc-jquery/jquery-1.11.2.min.js"></script>

    <!-- Handlebars -->
    <script src="inc-handlebars/handlebars-v3.0.0.js"></script>

    <!-- Scout2 -->
    <script src="inc-scout2/scout2.js"></script>
    <link href="inc-scout2/scout2.css" rel="stylesheet">
  </head>

  <body>

    <!-- Accordion partial -->
    <script id="accordion-partial" type="text/x-handlebars-template">
        <div class="list-group-item" style="padding-bottom: 0 !important;">
          <div class="accordion">
            <h4 class="list-group-item-heading accordion-heading">{{make_title member_type}}
              <a class="accordion-toggle" data-toggle="collapse" href="#{{service_name}}-{{resource_type}}-{{resource_id}}-{{member_type}}"><span class="badge pull-right btn-info">{{members.length}}</span></a>
            </h4>
            <div id="{{service_name}}-{{resource_type}}-{{resource_id}}-{{member_type}}" class="accordion-body collapse">
              <div class="accordion-inner">
                <ul>
                  {{#each members}}
                    <li>{{> (lookup .. 'member_partial_name')}}</li>
                  {{/each}}
                </ul>
              </div>
            </div>
          </div>
        </div>
    </script>
    <script>
        Handlebars.registerPartial("accordion", $("#accordion-partial").html());
    </script>

    <!-- Generic left-menu partial for region-then-resource -->
    <script id="per_region-partial" type="text/x-handlebars-template">
{{#if is_menu}}
      <ul class="list-group">
        <li class="list-group-item">
          <a href="javascript:showAll('{{service_name}}_{{resource_type}}')">
            Show all<span class="badge pull-right">{{count_in "{{service_name}}" "regions.{{resource_type}}"}}</span>
          </a>
        </li>
      </ul>
{{/if}}
      {{#each regions}}
{{#if ../is_menu}}
        <ul class="list-group" id="{{../service_name}}_region-list-{{@key}}">
          <li class="list-group-item active">{{@key}}</li>
{{/if}}
            {{#each (lookup . ../resource_type)}}
              {{> (lookup ../.. 'partial_name') service_name = ../../service_name region = @../key resource_type = ../../resource_type resource_key = @key resource = this}}
            {{/each}}
{{#if ../is_menu}}
        </ul>
{{/if}}
      {{/each}}
    </script>
    <script>
      Handlebars.registerPartial("per_region", $("#per_region-partial").html());
    </script>
    <!-- Generic left-menu link partial for region-then-resource -->
    <script id="per_region_link-partial" type="text/x-handlebars-template">
      <div class="list-group-item-text list-sub-element" id="{{service_name}}_{{resource_type}}-list-{{resource_key}}">
        <a href="#services.{{service_name}}.regions.{{region}}.{{resource_type}}.{{resource_key}}.details">{{resource_key}}</a>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("per_region_link", $("#per_region_link-partial").html());
    </script>

    <!-- Generic left-menu partial for region-then-vpc-then-resource -->
    <script id="per_vpc-partial" type="text/x-handlebars-template">
{{#if is_menu}}
      <ul class="list-group">
        <li class="list-group-item">
          <a href="javascript:showAllNew('services/{{service_name}}/regions')">
            Show all<span class="badge pull-right">{{count_in "{{service_name}}" "regions.vpcs.{{resource_type}}"}}</span>
          </a>
        </li>
      </ul>
{{/if}}
      {{#each regions}}
{{#if ../is_menu}}
        <ul class="list-group" id="{{../service_name}}_region-list-{{@key}}">
          <li class="list-group-item active">{{@key}}</li>
{{/if}}
          {{#each vpcs}}
{{#if ../../is_menu}}
            <div class="list-group-item list-sub-element">{{@key}}
{{/if}}
              {{#each (lookup . ../../resource_type)}}
                {{> (lookup ../../.. 'partial_name') service_name = ../../../service_name region = @../../key vpc = @../key resource_type = ../../../resource_type resource_key = @key resource = this}}
              {{/each}}
{{#if ../../is_menu}}
            </div>
{{/if}}
          {{/each}}
{{#if ../is_menu}}
        </ul>
{{/if}}
      {{/each}}
    </script>
    <script>
      Handlebars.registerPartial("per_vpc", $("#per_vpc-partial").html());
    </script>
    <!-- Generic left-menu link partial for region-then-vpc-then-resource -->
    <!-- TODO: fix this id -->
    <script id="per_vpc_link-partial" type="text/x-handlebars-template">
      <div class="list-group-item-text list-sub-element" id="{{service_name}}_{{resource_type}}-list-{{resource_key}}">
        <a href="#services/{{service_name}}/regions/{{region}}/vpcs/{{vpc}}/{{resource_type}}/{{resource_key}}/details">{{resource_key}}</a>
      </div>
    </script>
    <script>
      Handlebars.registerPartial("per_vpc_link", $("#per_vpc_link-partial").html());
    </script>


    <!-- Close popup button -->
    <script id="close_button-template" type="text/x-handlebars-template">
      <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
    </script>
    <script>
      var close_button_template = Handlebars.compile($("#close_button-template").html());
    </script>

    <!-- Single EC2 instance template -->
    <script id="single_ec2_instance-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> ec2_instance}}
    </script>
    <script>
        var single_ec2_instance_template = Handlebars.compile($("#single_ec2_instance-template").html());
    </script>

    <!-- Single EC2 VPC template -->
    <script id="single_ec2_vpc-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> ec2_vpc}}
    </script>
    <script>
        var single_ec2_vpc_template = Handlebars.compile($("#single_ec2_vpc-template").html());
    </script>

    <!-- Single EC2 Network ACL template -->
    <script id="single_ec2_network_acl-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> ec2_network_acl}}
    </script>
    <script>
        var single_ec2_network_acl_template = Handlebars.compile($("#single_ec2_network_acl-template").html());
    </script>

    <!-- Single EC2 security group template -->
    <script id="single_ec2_security_group-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> ec2_security_group}}
    </script>
    <script>
        var single_ec2_security_group_template = Handlebars.compile($("#single_ec2_security_group-template").html());
    </script>

    <!-- Single IAM group template -->
    <script id="single_iam_Group-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> iam_group}}
    </script>
    <script>
        var single_iam_group_template = Handlebars.compile($("#single_iam_Group-template").html());
    </script>

    <!-- Single IAM policy template -->
    <script id="single_iam_policy-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> iam_policy}}
        <hr>
    </script>
    <script>
        var single_iam_policy_template = Handlebars.compile($("#single_iam_policy-template").html());
    </script>

    <!-- Single IAM role template -->
    <script id="single_iam_Role-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> iam_role}}
    </script>
    <script>
        var single_iam_role_template = Handlebars.compile($("#single_iam_Role-template").html());
    </script>

    <!-- Single IAM user template -->
    <script id="single_iam_User-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> iam_user}}
    </script>
    <script>
        var single_iam_user_template = Handlebars.compile($("#single_iam_User-template").html());
    </script>

    <!-- Single RDS instance template -->
    <script id="single_rds_instance-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> rds_instance}}
    </script>
    <script>
        var single_rds_instance_template = Handlebars.compile($("#single_rds_instance-template").html());
    </script>

    <!-- Single Redshift cluster template -->
    <script id="single_redshift_cluster-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> redshift_cluster}}
    </script>
    <script>
        var single_redshift_cluster_template = Handlebars.compile($("#single_redshift_cluster-template").html());
    </script>

    <!-- Single S3 bucket template -->
    <script id="single_s3_bucket-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> s3_bucket}}
    </script>
    <script>
        var single_s3_bucket_template = Handlebars.compile($("#single_s3_bucket-template").html());
    </script>

    <!-- Single S3 object template -->
    <script id="single_s3_object-template" type="text/x-handlebars-template">
        <div style="text-align: right; padding-right: 10px; text-weight: bold;"><a href="javascript:hidePopup()">X</a></div>
        {{> s3_object}}
    </script>
    <script>
      var single_s3_object_template = Handlebars.compile($("#single_s3_object-template").html());
    </script>



    <!------------------>
    <!-- Fixed navbar -->
    <!------------------>


    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <span class="navbar-brand"><a href="javascript:show_main_dashboard()">AWS Scout2</a></span>
        </div>
        <div class="navbar-collapse collapse">
          <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav" id="dropdown-list">
            <script id="dropdown-list-template" type="text/x-handlebars-template">
              {{#each items}}
                <li class="dropdown">
                  <a href="javascript:show_{{@key}}()" class="dropdown-toggle" data-toggle="dropdown"><span id="cloudtrail_dropdown">{{make_title @key}}</span><b class="caret"></b></a>
                  <ul class="dropdown-menu">
                    <li class="dropdown-header">Summaries</li>
                    <li><a href="javascript:list_generic('{{@key}}.dashboard')">Dashboard</a></li>
                      {{#each summaries}}
                        <li><a href="javascript:list_generic('{{@../key}}', '{{@key}}')">{{make_title @key}}</a></li>
                      {{/each}}
                    <li class="divider"></li>
                    <li class="dropdown-header">{{make_title @key}} config</li>
                      {{#each resources}}
                        <li><a href="javascript:list_generic('{{this}}')">{{make_title @key}} ({{count}})</a></li>
                      {{/each}}
                    <li class="divider"></li>
                    <li class="dropdown-header">Security risks</li>
                    {{#each violations}}
                      {{#if flagged_items}}
                        <li><a href="javascript:list_findings('{{@../key}}', '{{@key}}')">
                          {{@key}} ({{flagged_items}})
                        </a></li>
                      {{/if}}
                    {{/each}}
                  </ul>
                </li>
              {{/each}}
            </script>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Regions<b class="caret"></b></a>
              <ul class="dropdown-menu" id="region-filters-list">
                <script id="region-filter-list-template" type="text/x-handlebars-template">
                  <li id="{{finding_entity keyword "region"}}-filter-select_none"><a href="javascript:clear_all_regions('{{keyword}}')">Hide all</a></li>
                  <li id="{{finding_entity keyword "region"}}-filter-select_all"><a href="javascript:select_all_regions('{{keyword}}')">Select all</a></li>
                  {{#each items}}
                    <li id="{{finding_entity ../keyword "region"}}-filter-{{@key}}"><a href="javascript:toggle_region('{{../keyword}}', '{{@key}}')"><i id="{{finding_entity ../keyword "region"}}-filtericon-{{@key}}" class="glyphicon glyphicon-check""></i> {{@key}}</a></li>
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Filters<b class="caret"></b></a>
              <ul class="dropdown-menu" id="filters-list">
                <script id="filter-list-template" type="text/x-handlebars-template">
                  {{#each items}}
                    <li id="{{finding_entity keyword_prefix entity}}-filter-{{@key}}"><a href="javascript:toggle_filter(aws_info['services']['{{keyword_prefix}}'], '{{@key}}')"><i id="{{finding_entity keyword_prefix entity}}-filtericon-{{@key}}" class="glyphicon glyphicon-unchecked""></i> {{description}} ({{items.length}})</a></li>
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Help<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="javascript:about()">About AWS Scout2</a></li>
              </ul>
            </li>
          </ul>
          </div>
        </div>
      </div>
    </div>



    <!--------------->
    <!-- Container -->
    <!--------------->


    <div class="container theme-showcase" id="container-user">

      <!-- Empty header -->
      <div class="page-header">
      </div>

      <!-- Overlay divs used to show entity details in pop up -->
      <div id="overlay-background" class="overlay-bg"></div>
      <div id="overlay-details" class="overlay col-sm-6"></div>

      <!-- Title section -->
      <div id="section_title-div">
          <h2 id="section_title-h2"></h2>
      </div>



      <!------------------------>
      <!-- Dashboards section -->
      <!------------------------>

      <!-- About-run dashboard -->
      <div class="row" id="about_run-row">
        <div id="about_run-list"></div>
        <script id="about_run-list-template" type="text/x-handlebars-template">
          <div class="list-group-item active">
            <h4 class="list-group-item-heading">Dashboard</h4>
          </div>
          <div class="list-group-item">
            <div class="list-group-item-text item-margin">Last run time: {{items.time}}</div>
            <div class="list-group-item-text item-margin">Last run command: {{items.cmd}}</div>
          </div>
        </script>
      </div><!-- /.row -->

      <!-- Service-specific dashboards -->
      <div class="row" id="dashboard-row">
        <div class="col-sm-12" id="dashboard-list">
          <script id="dashboard-list-template" type="text/x-handlebars-template">
            {{#each items}}
              {{> dashboard service_name = @key}}
            {{/each}}
          </script>
        </div>
      </div>

      <!-- Dasboard partial -->
      <script id="dashboard-partial" type="text/x-handlebars-template">
        <div class="row" id="{{service_name}}.dashboard-row">
          <div class="col-sm-12" id="{{service_name}}.dashboard-list">
            <div class="container">
              {{#if violations}}
                {{#grouped_each 3 violations}}
                  <div class="row">
                    {{#each this}}
                      <div class="col-sm-4">
                        <div class="list-group-item finding-title-{{dashboard_color level checked_items flagged_items}} plain-link">
                          <a href="javascript:list_findings('{{service}}', '{{@key}}')">
                            {{description}}
                          </a>
                        </div>
                        <div class="list-group-item">
                          <ul>
                            <li>{{friendly_name entity}} checked: {{checked_items}}</li>
                            <li>{{friendly_name entity}} flagged: {{flagged_items}}</li>
                          </ul>
                        </div>
                      </div>
                    {{/each}}
                  </div>
                {{/grouped_each}}
              {{/if}}
            </div>
          </div>
        </div>
      </script>
      <script>
        Handlebars.registerPartial("dashboard", $("#dashboard-partial").html());
      </script>



      <!------------------------>
      <!-- CloudTrail section -->
      <!------------------------>


      <!-- Trail partial -->
      <script id="cloudtrail.trails-partial" type="text/x-handlebars-template">
        <div class="list-group" id="services.cloudtrail.regions.{{region}}.trails.{{Name}}.details-">
          <div class="list-group-item active">
            <h4 class="list-group-item-heading">{{Name}}</h4>
          </div>
          <div class="list-group-item">
          <h4>Information</h4>
            <ul>
              <li class="list-group-item-text">Name: {{Name}}</li>
              <li class="list-group-item-text">Enabled: <span id="cloudtrail.regions.{{../name}}.trails.{{@key}}.IsLogging">{{IsLogging}}</span></li>
              <li class="list-group-item-text">Start Logging Time: {{StartLoggingTime}}</li>
              <li class="list-group-item-text">Stop Logging Time: {{StopLoggingTime}}</li>
              <li class="list-group-item-text">Include global services:
                <span id="cloudtrail_-global-services-duplicated-{{../name}}"><span id="cloudtrail_-no-global-services-{{../name}}">
                  {{#if IncludeGlobalServiceEvents}}True{{else}}False{{/if}}
                </span></span>
              </li>
              <li class="list-group-item-text">Destination S3 bucket name: <a href="javascript:showS3Bucket('{{S3BucketName}}')">{{S3BucketName}}</a>/{{S3KeyPrefix}}</li>
              <li class="list-group-item-text">EC2 instances: {{count_ec2_in_region name "vpcs.instances"}}
            </ul>
          </div>
        </div>
      </script>
      <script>
        Handlebars.registerPartial("cloudtrail.trails", $("#cloudtrail\\.trails-partial").html());
      </script>


      <!-- Trails list and details -->
      <div class="row" id="cloudtrail.trails-row">
        <div class="col-sm-4" id="cloudtrail.trails-list">
          <script id="cloudtrail.trails-list-template" type="text/x-handlebars-template">
            {{> per_region service_name = 'cloudtrail' resource_type = 'trails' regions = items partial_name = 'per_region_link' is_menu = true}}
          </script>
        </div>
        <div class="col-sm-8" id="cloudtrail.trails-details">
          <script id="cloudtrail.trails-details-template" type="text/x-handlebars-template">
            {{> per_region service_name = 'cloudtrail' resource_type = 'trails' regions = items partial_name = 'cloudtrail.trails'}}
          </script>
        </div>
      </div>



      <!----------------->
      <!-- EC2 section -->
      <!----------------->



      <!-- Template for network attack surface -->
      <div class="row" id="ec2_attack_surfaces-row">
        <div id="ec2_attack_surfaces-list">
          <script id="ec2_attack_surface-list-template" type="text/x-handlebars-template">
            <div class="list-group">
              <div class="row list-group-item active">
                <div class="col-sm-4"><h4>Public IP address</h4></div>
                <div class="col-sm-4"><h4>Open ports</h4></div>
                <div class="col-sm-4 pull-right"><h4><form>Filter by external IP:</h4> <input type="text" id="ec2_attack_surface_item_filter" onkeyup="filter_items('span', 'ec2_attack_surface_item')"></form></div>
              </div>
              {{#each items}}
                <div class="row list-group-item">
                  <div class="col-sm-4">{{@key}}</div>
                  <div class="col-sm-8">
                    <ul>
                    {{#each protocols ip = @key}}
                      <li class="list-group-item-text">{{@key}}</li>
                      <ul>
                      {{#each ports}}
                        <li>{{@key}}</li>
                        {{> ip_grants items = cidrs}}
                      {{/each}}
                      </ul>
                    {{/each}}
                    </ul>
                  </div>
                </div>
              {{/each}}
            </div>
          </script>
        </div>
      </div>

      <!-- Template for EC2 ELBs -->
      <div class="row" id="ec2_elbs-row">
        <div class="col-sm-4" id="ec2_elbs-list">
          <script id="ec2_elb-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('ec2_elb')">Show all<span class="badge pull-right">{{count_in "ec2" "regions.elbs"}}</span></a></li>
            </ul>
            {{#each items}}
             {{#if elbs}}
              <ul class="list-group">
                <li class="list-group-item active">{{@key}}</li>
                {{#each elbs}}
                  <div class="list-group-item list-sub-element" id="ec2_elb-list-{{@key}}"><a href="javascript:browseTo('ec2_elb', '{{@key}}')">{{@key}}</a></div>
                {{/each}}
              </ul>
             {{/if}}
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="ec2_elbs-details">
          <script id="ec2_elb-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            {{#each elbs}}
              {{> ec2_elb Name = @key}}
            {{/each}}
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for EC2 security groups -->
      <div class="row" id="ec2_security_groups-row">
        <div class="col-sm-4" id="ec2_security_groups-list">
          <script id="ec2_security_group-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('ec2_security_group')">Show all<span class="badge pull-right">{{count_in "ec2" "regions.vpcs.security_groups"}}</span></a></li>
            </ul>
            {{#each items}}
              <div id="ec2_region-list-{{@key}}">
                {{#if vpcs}}
                  <ul class="list-group">
                    <li class="list-group-item active">{{@key}}</li>
                    {{#each vpcs}}
                      <div class="list-group-item list-sub-element">
                        {{Name}}
                        {{#each security_groups}}
                          <div class="list-group-item-text list-sub-element" id="security_group-list-{{id}}"><a href="javascript:browseTo('ec2_security_group', '{{id}}')">{{name}}</a></div>
                        {{/each}}
                      </div>
                    {{/each}}
                  </ul>
                {{/if}}
              </div>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="ec2_security_groups-details">
          <script id="ec2_security_group-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            <div id="ec2_region-details-{{@key}}">
              {{#each vpcs}}
                {{#each security_groups}}
                  {{> ec2_security_group region=@../../key vpc=@../key}}
                {{/each}}
              {{/each}}
            </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for EC2 network ACLs -->
      <div class="row" id="ec2_network_acls-row">
        <div class="col-sm-4" id="ec2_network_acls-list">
          <script id="ec2_network_acl-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('ec2_network_acl')">Show all<span class="badge pull-right">{{count_in "ec2" "regions.vpcs.network_acls"}}</span></a></li>
            </ul>
            {{#each items}}
              <div id="ec2_region-list-{{@key}}">
                {{#if vpcs}}
                  <ul class="list-group">
                    <li class="list-group-item active">{{@key}}</li>
                    {{#each vpcs}}
                      <div class="list-group-item list-sub-element">
                        {{Name}}
                        {{#if network_acls}}
                          {{#each network_acls}}
                            <div class="list-group-item-text list-sub-element"><a href="javascript:browseTo('ec2_network_acl', '{{@key}}')">{{@key}}</a></div>
                          {{/each}}
                        {{/if}}
                      </div>
                    {{/each}}
                  </ul>
                {{/if}}
              </div>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="ec2_network_acls-details">
          <script id="ec2_network_acl-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            <div id="ec2_region-details-{{@key}}">
              {{#each vpcs}}
                {{#each network_acls}}
                  {{> ec2_network_acl RegionName = @../../key}}
                {{/each}}
              {{/each}}
            </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for EC2 VPCs -->
      <div class="row" id="ec2_vpcs-row">
        <div class="col-sm-4" id="ec2_vpcs-list">
          <script id="ec2_vpc-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('ec2_vpc')">Show all<span class="badge pull-right">{{count_in "ec2" "regions.vpcs"}}</span></a></li>
            </ul>
            {{#each items}}
              <div id="ec2_region-list-{{@key}}">
                {{#if vpcs}}
                  <ul class="list-group">
                    <li class="list-group-item active">{{@key}}</li>
                    {{#each vpcs}}
                        <div class="list-group-item-text list-sub-element" id="ec2_instance-list-{{id}}"><a href="javascript:browseTo('ec2_vpc', '{{id}}')">{{Name}}</a></div>
                    {{/each}}
                  </ul>
                {{/if}}
              </div>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="ec2_vpcs-details">
          <script id="ec2_vpc-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            <div id="ec2_region-details-{{@key}}">
              {{#each vpcs}}
                    {{> ec2_vpc region=../name}}
              {{/each}}
            </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for EC2 instances -->
      <div class="row" id="ec2_instances-row">
        <div class="col-sm-4" id="ec2_instances-list">
          <script id="ec2_instance-list-template" type="text/x-handlebars-template">
            <ul class="list-group">
              <li class="list-group-item"><a href="javascript:showAll('ec2_instance')">Show all<span class="badge pull-right">{{count_in "ec2" "regions.vpcs.instances"}}</span></a></li>
            </ul>
            {{#each items}}
              <div id="ec2_region-list-{{@key}}">
                {{#if vpcs}}
                  <ul class="list-group">
                    <li class="list-group-item active">{{@key}}</li>
                    {{#each vpcs}}
                      <div class="list-group-item list-sub-element">
                        {{Name}}
                        {{#each instances}}
                          <div class="list-group-item-text list-sub-element" id="ec2_instance-list-{{id}}"><a href="javascript:browseTo('ec2_instance', '{{InstanceId}}')">{{Name}}</a></div>
                        {{/each}}
                      </div>
                    {{/each}}
                  </ul>
                {{/if}}
              </div>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="ec2_instances-details">
          <script id="ec2_instance-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            <div id="ec2_region-details-{{@key}}">
              {{#each vpcs}}
                {{#each instances}}
                  {{> ec2_instance region=../../name}}
                {{/each}}
              {{/each}}
            </div>
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for IAM groups -->
      <div class="row" id="iam_Groups-row">
        <div class="col-sm-4">
          <ul class="list-group" id="iam_Groups-list">
            <script id="iam_Group-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('iam_Group')">Show all <span class="badge pull-right">{{count items}}</span></a></li>
            {{#each items}}
              <li class="list-group-item" id="iam_Group-list-{{Name}}">
                <a href="javascript:browseTo('iam_Group','{{Name}}')">{{Name}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="iam_Groups-details">
          <script id="iam_Group-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            {{> iam_group}}
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for IAM permissions -->
      <div class="row" id="iam_Permissions-row">
        <div id="iam_Permissions-list"></div>
          <script id="iam_Permission-list-template" type="text/x-handlebars-template">
          {{#each items}}
            <div class="list-group">
              <div class="row list-group-item active">
                <div class="col-sm-4"><h4>{{@key}} Permission</h4></div>
                <div class="col-sm-8"><h4>Details</h4></div>
              </div>
              {{#each this}}
                <div class="row list-group-item" id="iam_Permission-details-{{@key}}">
                  <div class="col-sm-4">{{@key}}:</div>
                  <div class="col-sm-8">
                    {{#each this}}
                      {{addMember 'type' @key}}
                      <div class="list-group-item-text">{{make_title @key}}:</div>
                      <ul>
                        {{#each this}}
                          {{#ifShow @key 'type'}}
                            <li class="list-group-item-text">{{make_title @key}}:</li>
                            <ul>
                              {{#each this}}
                                {{addMember 'name' @key}}
                                <li class="list-group-item-text"><a href="javascript:showObject(['services', 'iam', '{{../../../type}}', '{{@key}}'])">{{@key}}</a></li>
                                <ul>
                                  {{#each this}}
                                    {{#ifShow @key 'name'}}
                                      <li class="list-group-item-text">{{make_title @key}}s</li>
                                      <ul class="no-bullet">
                                        {{#each this}}
                                          {{addMember 'Resource' @key}}
                                          {{#each InlinePolicies}}
                                            <li>
                                              {{../Resource}} granted in <a href="javascript:showIAMInlinePolicy('{{../../../../../../../type}}', '{{../../../../name}}', '{{@key}}')">{{@key}}</a>
                                              {{#if condition}}
                                                <ul class="no-bullet">
                                                  <li class="list-group-item-text">Condition: {{condition}}</li>
                                                </ul>
                                              {{/if}}
                                            </li>
                                          {{/each}}
                                          {{#each ManagedPolicies}}
                                            <li>
                                              {{../Resource}} granted in <a href="javascript:showIAMManagedPolicy('{{@key}}')">{{policy_friendly_name @key}}</a>
                                              {{#if condition}}
                                                <ul class="no-bullet">
                                                  <li class="list-group-item-text">Condition: {{condition}}</li>
                                                </ul>
                                              {{/if}}
                                            </li>
                                          {{/each}}
                                        {{/each}}
                                      </ul>
                                    {{/ifShow}}
                                  {{/each}}
                                </ul>
                              {{/each}}
                            </ul>
                          {{/ifShow}}
                        {{/each}}
                      </ul>
                    {{/each}}
                  </div>
                </div>
              {{/each}}
            </div>
          {{/each}}
          </script>
      </div><!-- /.row -->

      <!-- Template for IAM root account overview -->
      <div class="row" id="iam_CredentialReports-row">
        <div id="iam_CredentialReports-list"></div>
          <script id="iam_CredentialReport-list-template" type="text/x-handlebars-template">
            <div class="list-group" id="iam_CredentialReport-details-">
              <div class="list-group-item active">
                <h4 class="list-group-item-heading">AWS root account</h4>
              </div>
              <div class="list-group-item">
                <div class="list-group-item-text item-margin">Creation date: {{items.user_creation_time}}</div>
                <div class="list-group-item-text item-margin">Password last used: <span id="iam_CredentialReport-root-active-password-">{{items.password_last_used}}</span></div>
                <div class="list-group-item-text item-margin">MFA enabled: <span id="iam_CredentialReport-root-no-mfa-">{{items.mfa_active}}</span></div>
                <div class="list-group-item-text item-margin">Access key 1 active: <span id="iam_CredentialReport-root-active-key-access_key_1_active">{{items.access_key_1_active}}</span></div>
                <div class="list-group-item-text item-margin">Access key 2 active: <span id="iam_CredentialReport-root-active-key-access_key_2_active">{{items.access_key_2_active}}</span></div>
                <div class="list-group-item-text item-margin">Signing cert 1 active: {{items.cert_1_active}}</div>
                <div class="list-group-item-text item-margin">Signing cert 2 active: {{items.cert_2_active}}</div>
              </div>
            </div>
          </script>
      </div><!-- /.row -->

      <!-- Template for IAM password policy overview -->
      <div class="row" id="iam_PasswordPolicys-row">
        <div id="iam_PasswordPolicys-list"></div>
          <script id="iam_PasswordPolicy-list-template" type="text/x-handlebars-template">
            <div class="list-group" id="iam_PasswordPolicy-details-">
              <div class="list-group-item active">
                <h4 class="list-group-item-heading">Password policy</h4>
              </div>
              <div class="list-group-item">
                <div class="list-group-item-text item-margin">Minimum password length: <span id="iam_PasswordPolicy-MinimumPasswordLength-">{{items.MinimumPasswordLength}}</span></div>
                <div class="list-group-item-text item-margin">Require at least one uppercase letter: <span id="iam_PasswordPolicy-RequireUppercaseCharacters-">{{items.RequireUppercaseCharacters}}</span></div>
                <div class="list-group-item-text item-margin">Require at least one lowercase letter: <span id="iam_PasswordPolicy-RequireLowercaseCharacters-">{{items.RequireLowercaseCharacters}}</span></div>
                <div class="list-group-item-text item-margin">Require at least one number: <span id="iam_PasswordPolicy-RequireNumbers-">{{items.RequireNumbers}}</span></div>
                <div class="list-group-item-text item-margin">Require at least one non-alphanumeric character: <span id="iam_PasswordPolicy-RequireSymbols-">{{items.RequireSymbols}}</span></div>
                <div class="list-group-item-text item-margin">Enable password expiration: <span id="iam_PasswordPolicy-ExpirePasswords-">{{items.ExpirePasswords}}</span></div>
                {{#if items.MaxPasswordAge}}
                  <div class="list-group-item-text item-margin">Password expiration period (in days): <span id="iam_PasswordPolicy-MaxPasswordAge-">{{items.MaxPasswordAge}}</span></div>
                {{/if}}
                <div class="list-group-item-text item-margin">Prevent password reuse: <span id="iam_PasswordPolicy-PasswordReusePrevention-">{{items.PasswordReusePrevention}}</span></div>
                {{#if items.PreviousPasswordPrevented}}
                  <div class="list-group-item-text item-margin">Number of passwords to remember: <span id="iam_PasswordPolicy-PreviousPasswordPrevented-">{{items.PreviousPasswordPrevented}}</span></div>
                <div class="list-group-item-text item-margin">Allow users to change their own password: <span id="iam_PasswordPolicy-AllowUsersToChangePassword-">{{items.AllowUsersToChangePassword}}</span></div>
                <div class="list-group-item-text item-margin">Allow users to set a new password after their password has expired: <span id="iam_PasswordPolicy-HardExpiry-">{{items.HardExpiry}}</span></div>
                {{/if}}
              </div>
            </div>
          </script>
      </div><!-- /.row -->

      <!-- Template for IAM roles -->
      <div class="row" id="iam_Roles-row">
        <div class="col-sm-3">
          <ul class="list-group" id="iam_Roles-list">
            <script id="iam_Role-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('iam_Role')">Show all <span class="badge pull-right">{{count items}}</span></a></li>
            {{#each items}}
              <li class="list-group-item" id="iam_Role-list-{{Name}}">
                <a href="javascript:browseTo('iam_Role','{{Name}}')">{{Name}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="iam_Roles-details">
          <script id="iam_Role-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            {{> iam_role}}
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->

      <!-- Template for IAM users -->
      <div class="row" id="iam_Users-row">
        <div class="col-sm-4">
          <ul class="list-group" id="iam_Users-list">
            <script id="iam_User-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('iam_User')">Show all <span class="badge pull-right">{{count items}}</span></a></li>
            {{#each items}}
              <li class="list-group-item" id="iam_User-list-{{Name}}">
                <a href="javascript:browseTo('iam_User','{{Name}}')">{{Name}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="iam_Users-details">
          <script id="iam_User-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            {{> iam_user}}
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->



      <!---------------------->
      <!-- RDS section -->
      <!---------------------->



      <!-- RDS instances -->
      <div class="row" id="rds_instances-row">
        <div class="col-sm-4" id="rds_instances-list">
          <script id="rds_instance-list-template" type="text/x-handlebars-template">
            {{> per_vpc service_name = 'rds' resource_type = 'instances' regions = items partial_name = 'per_vpc_link' is_menu = true}}
          </script>
        </div>
        <div class="col-sm-8" id="rds_instances-details">
          <script id="rds_instance-detail-template" type="text/x-handlebars-template">
            {{> per_vpc service_name = 'rds' resource_type = 'instances' regions = items partial_name = 'rds_instance'}}
          </script>
        </div>
      </div>

      <!-- RDS security groups -->
      <div class="row" id="rds_security_groups-row">
        <div class="col-sm-4" id="rds_security_groups-list">
          <script id="rds_security_group-list-template" type="text/x-handlebars-template">
            {{> per_vpc service_name = 'rds' resource_type = 'security_groups' regions = items partial_name = 'per_vpc_link' is_menu = true}}
          </script>
        </div>
        <div class="col-sm-8" id="rds_security_groups-details">
          <script id="rds_security_group-detail-template" type="text/x-handlebars-template">
            {{> per_vpc service_name = 'rds' resource_type = 'security_groups' regions = items partial_name = 'rds_security_group'}}
          </script>
        </div>
      </div>



      <!---------------------->
      <!-- Redshift section -->
      <!---------------------->



      <!-- Redshift clusters -->
      <div class="row" id="redshift_clusters-row">
        <div class="col-sm-4" id="redshift_clusters-list">
          <script id="redshift_cluster-list-template" type="text/x-handlebars-template">
            {{> per_vpc service_name = 'redshift' resource_type = 'clusters' regions = items partial_name = 'per_vpc_link' is_menu = true}}
          </script>
        </div>
        <div class="col-sm-8" id="redshift_clusters-details">
          <script id="redshift_cluster-detail-template" type="text/x-handlebars-template">
            {{> per_vpc service_name = 'redshift' resource_type = 'clusters' regions = items partial_name = 'redshift_cluster'}}
          </script>
        </div>
      </div>

      <!-- Redshift parameter groups -->
      <div class="row" id="redshift_parameter_groups-row">
        <div class="col-sm-4" id="redshift_parameter_groups-list">
          <script id="redshift_parameter_group-list-template" type="text/x-handlebars-template">
            {{> per_region service_name = 'redshift' resource_type = 'parameter_groups' regions = items partial_name = 'per_region_link' is_menu = true}}
          </script>
        </div>
        <div class="col-sm-8" id="redshift_parameter_groups-details">
          <script id="redshift_parameter_group-detail-template" type="text/x-handlebars-template">
            {{> per_region service_name = 'redshift' resource_type = 'parameter_groups' regions = items partial_name = 'redshift_parameter_group'}}
          </script>
        </div>
      </div>

      <!-- Redshift security groups -->
      <div class="row" id="redshift_security_groups-row">
        <div class="col-sm-4" id="redshift_security_groups-list">
          <script id="redshift_security_group-list-template" type="text/x-handlebars-template">
            {{> per_vpc service_name = 'redshift' resource_type = 'security_groups' regions = items partial_name = 'per_vpc_link' is_menu = true}}
          </script>
        </div>
        <div class="col-sm-8" id="redshift_security_groups-details">
          <script id="redshift_security_group-detail-template" type="text/x-handlebars-template">
            {{> per_vpc service_name = 'redshift' resource_type = 'security_groups' regions = items partial_name = 'redshift_security_group'}}
          </script>
        </div>
      </div>



      <!---------------->
      <!-- S3 section -->
      <!---------------->



      <!-- S3 buckets -->
      <div class="row" id="s3_buckets-row">
        <div class="col-sm-4">
          <ul class="list-group" id="s3_buckets-list">
            <script id="s3_bucket-list-template" type="text/x-handlebars-template">
            <li class="list-group-item"><a href="javascript:showAll('s3_bucket')">Show all <span class="badge pull-right">{{count items}}</span></a></li>
            {{#each items}}
              <li class="list-group-item" id="s3_bucket-list-{{@key}}">
                <a href="javascript:browseTo('s3_bucket','{{@key}}')">{{@key}}</a>
              </li>
            {{/each}}
            </script>
          </ul>
        </div>
        <div class="col-sm-8" id="s3_buckets-details">
          <script id="s3_bucket-detail-template" type="text/x-handlebars-template">
          {{#each items}}
            {{> s3_bucket}}
          {{/each}}
          </script>
        </div><!-- /.col-sm-8 -->
      </div><!-- /.row -->



      <div class="row" id="about-row">
        <div class="list-group">
          <div class="row list-group-item active">
            About
          </div>
          <div class="row list-group-item">
            <p>&nbsp;</p>
            <p>AWS Scout2 is an open-source security tool release by <a href="https://www.isecpartners.com" target="_blank">iSEC Partners</a>.</p>
            <p>&nbsp;</p>
            <p>Use the top navigation bar to review the configuration of the
            supported AWS services. For more information about Scout2, please
            check out the project's page on
            <a href="https://github.com/iSECPartners/Scout2" target="_blank">Github</a>
            and the project's website at
            <a href="https://isecpartners.github.io/Scout2/" target="_blank">https://isecpartners.github.io/Scout2/</a>.
            <p>&nbsp;</p>
            The AWS documentation is available at
            <a href="https://aws.amazon.com/documentation" target="_blank">https://aws.amazon.com/documentation</a>.
            </p>
          </div>
        </div>
      </div>

      <div class="row" id="please_wait-row">
        <div class="list-group">
          <div class="row list-group-item active">
            Please wait
          </div>
          <div class="row list-group-item">
            <p>&nbsp;</p>
            <p>Loading data, this may take a while...</p>
            <p>&nbsp;</p>
          </div>
        </div>
      </div>

    </div> <!-- /container -->

    <!-- Include all AWS services configs -->
    <script src="inc-awsconfig/aws_config.js"></script>

    <!-- Bootstrap core JavaScript, placed at the end of the document so the pages load faster -->
    <script src="inc-bootstrap/js/bootstrap.min.js"></script>

    <!-- Display dashbord -->
    <script>load_dashboards();</script>

    <!-- Hide the please wait message -->
    <script>$('#please_wait-row').hide();</script>

  </body>
</html>
