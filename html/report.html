<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>AWS Scout2 Report</title>

    <!-- Bootstrap core CSS -->
    <link href="inc-bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap theme -->
    <link href="inc-bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <!-- jQuery -->
    <script src="inc-jquery/jquery-1.11.2.min.js"></script>

    <!-- Handlebars -->
    <script src="inc-handlebars/handlebars-v3.0.0.js"></script>

    <!-- Scout2 -->
    <script src="inc-scout2/scout2.js"></script>
    <link href="inc-scout2/scout2.css" rel="stylesheet">
  </head>

  <body>

    <!------------------>
    <!-- Fixed navbar -->
    <!------------------>

    <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <span class="navbar-brand"><a href="javascript:show_main_dashboard()">AWS Scout2</a></span>
        </div>
        <div class="navbar-collapse collapse">
          <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav" id="dropdown.list">
            <script id="dropdown.list.template" type="text/x-handlebars-template">
              {{#each items}}
                <li class="dropdown">
                  <a href="javascript:show_{{@key}}()" class="dropdown-toggle" data-toggle="dropdown"><span id="cloudtrail_dropdown">{{make_title @key}}</span><b class="caret"></b></a>
                  <ul class="dropdown-menu">
                    <li class="dropdown-header">Summaries</li>
                    <li><a href="javascript:list_generic('metadata.{{@key}}.dashboard', '{{@key}}.dashboard', '1')">Dashboard</a></li>
                      {{#each summaries}}
                        <li><a href="javascript:list_generic('{{@../key}}', '{{@key}}')">{{make_title @key}}</a></li>
                      {{/each}}
                    <li class="divider"></li>
                    <li class="dropdown-header">{{make_title @key}} config</li>
                      {{#each resources}}
                        <li><a href="javascript:list_generic('{{script}}', '{{path}}', '{{cols}}')">{{make_title @key}} ({{count}})</a></li>
                      {{/each}}
                    <li class="divider"></li>
                    <li class="dropdown-header">Security risks</li>
                    {{#each violations}}
                      {{#if flagged_items}}
                        <li><a href="javascript:list_findings('{{@../key}}', '{{@key}}')">
                          {{@key}} ({{flagged_items}})
                        </a></li>
                      {{/if}}
                    {{/each}}
                  </ul>
                </li>
              {{/each}}
            </script>
          </ul>
          <ul class="nav navbar-nav navbar-right">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Regions<b class="caret"></b></a>
              <ul class="dropdown-menu" id="region-filters.list">
                <script id="region-filter.list.template" type="text/x-handlebars-template">
                  <li id="{{finding_entity keyword "region"}}-filter-select_none"><a href="javascript:clear_all_regions('{{keyword}}')">Hide all</a></li>
                  <li id="{{finding_entity keyword "region"}}-filter-select_all"><a href="javascript:select_all_regions('{{keyword}}')">Select all</a></li>
                  {{#each items}}
                    <li id="{{finding_entity ../keyword "region"}}-filter-{{@key}}">
                      <a href="javascript:toggle_region('{{../keyword}}', '{{@key}}')"><i id="{{finding_entity ../keyword "region"}}-filtericon-{{@key}}" class="glyphicon glyphicon-check""></i> {{@key}}</a>
                    </li>
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Filters<b class="caret"></b></a>
              <ul class="dropdown-menu" id="filters.list">
                <script id="filter.list.template" type="text/x-handlebars-template">
                  {{#each items}}
                    <li id="{{finding_entity keyword_prefix entity}}-filter-{{@key}}">
                      <a href="javascript:toggle_filter(aws_info['services']['{{keyword_prefix}}'], '{{@key}}')"><i id="{{finding_entity keyword_prefix entity}}-filtericon-{{@key}}" class="glyphicon glyphicon-unchecked""></i> {{description}} ({{items.length}})</a>
                    </li>
                  {{/each}}
                </script>
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Help<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="javascript:about()">About AWS Scout2</a></li>
              </ul>
            </li>
          </ul>
          </div>
        </div>
      </div>
    </div>

    <!--------------->
    <!-- Container -->
    <!--------------->

    <div class="container theme-showcase" id="container-user">

      <!-- Empty header -->
      <div class="page-header">
      </div>

      <!-- Overlay divs used to show entity details in pop up -->
      <div id="overlay-background" class="overlay-bg"></div>
      <div id="overlay-details" class="overlay col-sm-6"></div>

      <!-- Title section -->
      <div id="section_title-div">
          <h2 id="section_title-h2"></h2>
      </div>

      <!------------------------>
      <!-- Dashboards section -->
      <!------------------------>

      <!-- About-run dashboard -->
      <div class="row" id="about_run.row">
        <div id="about_run.list"></div>
        <script id="about_run.list.template" type="text/x-handlebars-template">
          <div class="list-group-item active">
            <h4 class="list-group-item-heading">Dashboard</h4>
          </div>
          <div class="list-group-item">
            <div class="list-group-item-text item-margin">Last run time: {{items.time}}</div>
            <div class="list-group-item-text item-margin">Last run command: {{items.cmd}}</div>
          </div>
        </script>
      </div>

      <!-- Service-specific dashboards -->
      <div class="row" id="services.violations.row">
        <div class="col-sm-12" id="services.violations.list">
          <script id="services.violations.list.template" type="text/x-handlebars-template">
            {{#each items}}
              {{> dashboard service_name = @key}}
            {{/each}}
          </script>
        </div>
      </div>

      <!-- Dasboard partial -->
      <script id="dashboard.partial" type="text/x-handlebars-template">
        <div class="row" id="metadata.{{service_name}}.violations.row">
          <div class="col-sm-12" id="metadata.{{service_name}}.violations.list">
            <div class="container">
              {{#if violations}}
                {{#grouped_each 3 violations}}
                  <div class="row">
                    {{#each this}}
                      <div class="col-sm-4">
                        <div class="list-group-item finding-title-{{dashboard_color level checked_items flagged_items}} plain-link">
                          <a href="javascript:list_findings('{{service}}', '{{@key}}')">
                            {{description}}
                          </a>
                        </div>
                        <div class="list-group-item">
                          <ul>
                            <li>{{friendly_name entity}} checked: {{checked_items}}</li>
                            <li>{{friendly_name entity}} flagged: {{flagged_items}}</li>
                          </ul>
                        </div>
                      </div>
                    {{/each}}
                  </div>
                {{/grouped_each}}
              {{/if}}
            </div>
          </div>
        </div>
      </script>
      <script>
        Handlebars.registerPartial("dashboard", $("#dashboard\\.partial").html());
      </script>

      <!-- PLACEHOLDER -->

    </div> <!-- /container -->

    <!-- Include all AWS services configs -->
    <script src="inc-awsconfig/aws_config.js"></script>

    <!-- Bootstrap core JavaScript, placed at the end of the document so the pages load faster -->
    <script src="inc-bootstrap/js/bootstrap.min.js"></script>

    <!-- Display dashbord -->
    <script>load_dashboards();</script>

    <!-- Hide the please wait message -->
    <script>$('#please_wait-row').hide();</script>

  </body>
</html>
