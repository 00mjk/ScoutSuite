
<!----------------->
<!-- IAM section -->
<!----------------->

<div class="row" id="services.iam.row">

  <!-- Template for IAM permissions -->
  <div class="row" id="iam_Permissions.row">
    <div id="iam_Permissions.list"></div>
      <script id="iam_Permission.list.template" type="text/x-handlebars-template">
      {{#each items}}
        <div class="list-group">
          <div class="row list-group-item active">
            <div class="col-sm-4"><h4>{{@key}} Permission</h4></div>
            <div class="col-sm-8"><h4>Details</h4></div>
          </div>
          {{#each this}}
            <div class="row list-group-item" id="iam_Permission-details-{{@key}}">
              <div class="col-sm-4">{{@key}}:</div>
              <div class="col-sm-8">
                {{#each this}}
                  {{addMember 'type' @key}}
                  <div class="list-group-item-text">{{make_title @key}}:</div>
                  <ul>
                    {{#each this}}
                      {{#ifShow @key 'type'}}
                        <li class="list-group-item-text">{{make_title @key}}:</li>
                        <ul>
                          {{#each this}}
                            {{addMember 'name' @key}}
                            <li class="list-group-item-text"><a href="javascript:showObject(['services', 'iam', '{{../../../type}}', '{{@key}}'])">{{@key}}</a></li>
                            <ul>
                              {{#each this}}
                                {{#ifShow @key 'name'}}
                                  <li class="list-group-item-text">{{make_title @key}}s</li>
                                  <ul class="no-bullet">
                                    {{#each this}}
                                      {{addMember 'Resource' @key}}
                                      {{#each InlinePolicies}}
                                        <li>
                                          {{../Resource}} granted in <a href="javascript:showIAMInlinePolicy('{{../../../../../../../type}}', '{{../../../../name}}', '{{@key}}')">{{@key}}</a>
                                          {{#if condition}}
                                            <ul class="no-bullet">
                                              <li class="list-group-item-text">Condition: {{condition}}</li>
                                            </ul>
                                          {{/if}}
                                        </li>
                                      {{/each}}
                                      {{#each ManagedPolicies}}
                                        <li>
                                          {{../Resource}} granted in <a href="javascript:showIAMManagedPolicy('{{@key}}')">{{policy_friendly_name @key}}</a>
                                          {{#if condition}}
                                            <ul class="no-bullet">
                                              <li class="list-group-item-text">Condition: {{condition}}</li>
                                            </ul>
                                          {{/if}}
                                        </li>
                                      {{/each}}
                                    {{/each}}
                                  </ul>
                                {{/ifShow}}
                              {{/each}}
                            </ul>
                          {{/each}}
                        </ul>
                      {{/ifShow}}
                    {{/each}}
                  </ul>
                {{/each}}
              </div>
            </div>
          {{/each}}
        </div>
      {{/each}}
      </script>
  </div><!-- /.row -->

  <!-- Root account usage -->
  <div class="row" id="services.iam.root_account.row">
    <div id="services.iam.root_account.list"></div>
      <script id="services.iam.root_account.list.template" type="text/x-handlebars-template">
        <div class="list-group" id="services.iam.root_account.details">
          <div class="list-group-item active">
            <h4 class="list-group-item-heading">AWS root account</h4>
          </div>
          <div class="list-group-item">
            <div class="list-group-item-text item-margin">Creation date: {{items.user_creation_time}}</div>
            <div class="list-group-item-text item-margin">Password last used: <span id="iam_CredentialReport-root-active-password-">{{items.password_last_used}}</span></div>
            <div class="list-group-item-text item-margin">MFA enabled: <span id="iam_CredentialReport-root-no-mfa-">{{items.mfa_active}}</span></div>
            <div class="list-group-item-text item-margin">Access key 1 active: <span id="iam_CredentialReport-root-active-key-access_key_1_active">{{items.access_key_1_active}}</span></div>
            <div class="list-group-item-text item-margin">Access key 2 active: <span id="iam_CredentialReport-root-active-key-access_key_2_active">{{items.access_key_2_active}}</span></div>
            <div class="list-group-item-text item-margin">Signing cert 1 active: {{items.cert_1_active}}</div>
            <div class="list-group-item-text item-margin">Signing cert 2 active: {{items.cert_2_active}}</div>
          </div>
        </div>
      </script>
  </div><!-- /.row -->

  <!-- Password policy -->
  <div class="row" id="services.iam.PasswordPolicy.row">
    <div id="services.iam.PasswordPolicy.list"></div>
      <script id="services.iam.PasswordPolicy.list.template" type="text/x-handlebars-template">
        <div class="list-group" id="services.iam.PasswordPolicy.details">
          <div class="list-group-item active">
            <h4 class="list-group-item-heading">Password policy</h4>
          </div>
          <div class="list-group-item">
            <div class="list-group-item-text item-margin">Minimum password length: <span id="iam_PasswordPolicy-MinimumPasswordLength-">{{items.MinimumPasswordLength}}</span></div>
            <div class="list-group-item-text item-margin">Require at least one uppercase letter: <span id="iam_PasswordPolicy-RequireUppercaseCharacters-">{{items.RequireUppercaseCharacters}}</span></div>
            <div class="list-group-item-text item-margin">Require at least one lowercase letter: <span id="iam_PasswordPolicy-RequireLowercaseCharacters-">{{items.RequireLowercaseCharacters}}</span></div>
            <div class="list-group-item-text item-margin">Require at least one number: <span id="iam_PasswordPolicy-RequireNumbers-">{{items.RequireNumbers}}</span></div>
            <div class="list-group-item-text item-margin">Require at least one non-alphanumeric character: <span id="iam_PasswordPolicy-RequireSymbols-">{{items.RequireSymbols}}</span></div>
            <div class="list-group-item-text item-margin">Enable password expiration: <span id="iam_PasswordPolicy-ExpirePasswords-">{{items.ExpirePasswords}}</span></div>
            {{#if items.MaxPasswordAge}}
              <div class="list-group-item-text item-margin">Password expiration period (in days): <span id="iam_PasswordPolicy-MaxPasswordAge-">{{items.MaxPasswordAge}}</span></div>
            {{/if}}
            <div class="list-group-item-text item-margin">Prevent password reuse: <span id="iam_PasswordPolicy-PasswordReusePrevention-">{{items.PasswordReusePrevention}}</span></div>
            {{#if items.PreviousPasswordPrevented}}
              <div class="list-group-item-text item-margin">Number of passwords to remember: <span id="iam_PasswordPolicy-PreviousPasswordPrevented-">{{items.PreviousPasswordPrevented}}</span></div>
            <div class="list-group-item-text item-margin">Allow users to change their own password: <span id="iam_PasswordPolicy-AllowUsersToChangePassword-">{{items.AllowUsersToChangePassword}}</span></div>
            <div class="list-group-item-text item-margin">Allow users to set a new password after their password has expired: <span id="iam_PasswordPolicy-HardExpiry-">{{items.HardExpiry}}</span></div>
            {{/if}}
          </div>
        </div>
      </script>
  </div>

  <!-- Group list and details -->
  <div class="row" id="services.iam.Groups.row">
    <div class="col-sm-4">
      <ul class="list-group" id="services.iam.Groups.list">
        <script id="services.iam.Groups.list.template" type="text/x-handlebars-template">
          {{> global_link service_name = 'iam' resource_type = 'Groups' resource_id_name = 'Name'}}
        </script>
      </ul>
    </div>
    <div class="col-sm-8" id="services.iam.Groups.details">
      <script id="services.iam.Groups.details.template" type="text/x-handlebars-template">
      {{#each items}}
        {{> services.iam.Groups}}
      {{/each}}
      </script>
    </div>
  </div>

  <!-- Role list and details -->
  <div class="row" id="services.iam.Roles.row">
    <div class="col-sm-4">
      <ul class="list-group" id="services.iam.Roles.list">
        <script id="services.iam.Roles.list.template" type="text/x-handlebars-template">
          {{> global_link service_name = 'iam' resource_type = 'Roles' resource_id_name = 'Name'}}
        </script>
      </ul>
    </div>
    <div class="col-sm-8" id="services.iam.Roles.details">
      <script id="services.iam.Roles.details.template" type="text/x-handlebars-template">
      {{#each items}}
        {{> services.iam.Roles}}
      {{/each}}
      </script>
    </div>
  </div>

  <!-- User list and details -->
  <div id="services.iam.Users.row" />
    <div class="col-sm-4">
      <ul class="list-group" id="services.iam.Users.list" />
        <script id="services.iam.Users.list.template" type="text/x-handlebars-template">
          {{> global_link service_name = 'iam' resource_type = 'Users' resource_id_name = 'Name'}}
        </script>
      </ul>
    </div>
    <div class="col-sm-8" id="services.iam.Users.details">
      <script id="services.iam.Users.details.template" type="text/x-handlebars-template">
        {{#each items}}
          {{> services.iam.Users}}
        {{/each}}
      </script>
    </div>
  </div>

</div><!-- services.iam.row -->

