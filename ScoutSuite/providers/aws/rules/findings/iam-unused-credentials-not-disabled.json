{
    "arg_names": [ "Period in days" ],
    "description": "Credentials unused for _ARG_0_ days or greater are not disabled",
    "rationale": "Disabling or removing unnecessary credentials will reduce the window of opportunity for compromised accounts to be used.",
    "remediation": "Ensure that all credentials (including passwords and access keys) have been used and changed in the last _ARG_0_ days",
    "compliance": [
        {"name": "CIS Amazon Web Services Foundations", "version": "1.0.0", "reference": "1.3"},
        {"name": "CIS Amazon Web Services Foundations", "version": "1.1.0", "reference": "1.3"},
        {"name": "CIS Amazon Web Services Foundations", "version": "1.2.0", "reference": "1.3"}
    ],
    "dashboard_name": "Users",
    "path": "iam.credential_reports.id",
    "conditions": [ "or",
        [
            "and",
            [ "iam.credential_reports.id.password_enabled", "true", "" ],
            [
                "or",
                [ "iam.credential_reports.id.password_last_used", "olderThan", ["_ARG_0_", "days"] ],
                [ "iam.credential_reports.id.password_last_changed", "olderThan", ["_ARG_0_", "days"] ]
            ]
        ],
        [
            "and",
            [ "iam.credential_reports.id.access_key_1_active", "true", "" ],
            [
                "or",
                [ "iam.credential_reports.id.access_key_1_last_used_date", "olderThan", ["_ARG_0_", "days"] ],
                [ "iam.credential_reports.id.access_key_1_last_rotated", "olderThan", ["_ARG_0_", "days"] ]
            ]
        ],
        [
            "and",
            [ "iam.credential_reports.id.access_key_2_active", "true", "" ],
            [
                "or",
                [ "iam.credential_reports.id.access_key_2_last_used_date", "olderThan", ["_ARG_0_", "days"] ],
                [ "iam.credential_reports.id.access_key_2_last_rotated", "olderThan", ["_ARG_0_", "days"] ]
            ]
        ]
    ],
    "class_suffix": "unused_credentials"
}
